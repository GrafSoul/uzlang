import{r as u,j as e,B as re,a as Qt,A as Ht,d as Ka,S as c,e as l,I as ua,L as Xt,D as $t,P as E,f as sa,h as se,i as V,k as b,G as A,l as O,m as Fa,n as ue,o as Pa,p as _e,W as Jt,E as Vt,q as Ya,s as Ga,t as Qa,u as Ha,v as Zt,w as ei,x as ai,y as qe,V as Xa,z as ti}from"./vendor-ui-CQ3Liuo7.js";import{i as ii,w as si}from"./vendor-sqljs-DkhnlS0i.js";const ra="/uzlang/";function L(a){const i=ra.endsWith("/")?ra:`${ra}/`,s=a.startsWith("/")?a.slice(1):a;return i+s}const lt=[{key:"store",title:"Покупки в магазине",description:"Продукты, цены, оплата, вежливые вопросы."},{key:"bazaar",title:"Базар: овощи и фрукты",description:"Торг, количество, свежесть, просьбы."},{key:"city",title:"Поездка по городу",description:"Маршрутка, такси, остановка, направление."},{key:"neighbors",title:"Соседи и погода",description:"Бытовое общение во дворе и дома."},{key:"family",title:"Поздравления и семья",description:"Кто родился, поздравления, теплые фразы."},{key:"pharmacy",title:"Аптека и здоровье",description:"Покупка лекарств, симптомы, базовые вопросы."},{key:"clinic",title:"Поликлиника и запись",description:"Регистрация, очередь, время приема."},{key:"cafe",title:"Кафе и чайхана",description:"Заказ, состав блюда, оплата счета."},{key:"housing",title:"Аренда жилья и быт",description:"Квартира, коммуналка, поломки, хозяин."},{key:"taxi",title:"Такси: продвинутые кейсы",description:"Пробки, ожидание, смена маршрута, точки."},{key:"transport",title:"Общественный транспорт",description:"Пересадки, линии, остановки, проезд."},{key:"work",title:"Работа и офис",description:"График, встречи, задачи и документы."},{key:"bank",title:"Банк и платежи",description:"Карта, перевод, комиссия, баланс."},{key:"school",title:"Детский сад и школа",description:"Расписание, учитель, собрания, справки."},{key:"repair",title:"Сервис и ремонт",description:"Ремонт техники и сроки выполнения."},{key:"delivery",title:"Почта и доставка",description:"Адрес, курьер, самовывоз, оплата."},{key:"documents",title:"Госуслуги и документы",description:"Регистрация, справки, подпись и окна."}],g={store:L("images/store.svg"),bazaar:L("images/bazaar.svg"),city:L("images/city.svg"),neighbors:L("images/neighbors.svg"),family:L("images/family.svg"),pharmacy:L("images/store.svg"),clinic:L("images/city.svg"),cafe:L("images/bazaar.svg"),housing:L("images/neighbors.svg"),taxi:L("images/city.svg"),transport:L("images/city.svg"),work:L("images/city.svg"),bank:L("images/store.svg"),school:L("images/family.svg"),repair:L("images/store.svg"),delivery:L("images/bazaar.svg"),documents:L("images/city.svg")},ri=[{topicKey:"store",imageUrl:g.store,uz:"Assalomu alaykum",reading:"ассалому алайкум",ru:"Здравствуйте",exampleUz:"Assalomu alaykum, non bormi?",exampleRu:"Здравствуйте, хлеб есть?"},{topicKey:"store",imageUrl:g.store,uz:"Qancha turadi?",reading:"канча туради",ru:"Сколько стоит?",exampleUz:"Bu sut qancha turadi?",exampleRu:"Сколько стоит это молоко?"},{topicKey:"store",imageUrl:g.store,uz:"Arzonroq bering",reading:"арзонрок беринг",ru:"Дайте дешевле",exampleUz:"Iloji bo‘lsa, arzonroq bering.",exampleRu:"Если можно, дайте дешевле."},{topicKey:"store",imageUrl:g.store,uz:"Karta qabul qilasizmi?",reading:"карта қабул қиласизми",ru:"Принимаете карту?",exampleUz:"Karta qabul qilasizmi yoki faqat naqdmi?",exampleRu:"Принимаете карту или только наличные?"},{topicKey:"store",imageUrl:g.store,uz:"Yaroqlilik muddati qachongacha?",reading:"яроклилик муддати качонгача",ru:"Какой срок годности?",exampleUz:"Bu yogurtning yaroqlilik muddati qachongacha?",exampleRu:"Какой срок годности у этого йогурта?"},{topicKey:"store",imageUrl:g.store,uz:"Yana bitta paket bering",reading:"яна битта пакет беринг",ru:"Дайте еще один пакет",exampleUz:"Iltimos, yana bitta paket bering.",exampleRu:"Пожалуйста, дайте еще один пакет."},{topicKey:"store",imageUrl:g.store,uz:"Qaytim bering, iltimos",reading:"кайтим беринг илтимос",ru:"Дайте сдачу, пожалуйста",exampleUz:"Menga qaytim bering, iltimos.",exampleRu:"Дайте мне сдачу, пожалуйста."},{topicKey:"store",imageUrl:g.store,uz:"Chegirma bormi?",reading:"чегирма борми",ru:"Есть скидка?",exampleUz:"Shu mahsulotga chegirma bormi?",exampleRu:"На этот товар есть скидка?"},{topicKey:"bazaar",imageUrl:g.bazaar,uz:"Yangi meva bormi?",reading:"янги мева борми",ru:"Есть свежие фрукты?",exampleUz:"Yangi olma va nok bormi?",exampleRu:"Есть свежие яблоки и груши?"},{topicKey:"bazaar",imageUrl:g.bazaar,uz:"Bir kilo bering",reading:"бир кило беринг",ru:"Дайте один килограмм",exampleUz:"Pomidordan bir kilo bering.",exampleRu:"Дайте килограмм помидоров."},{topicKey:"bazaar",imageUrl:g.bazaar,uz:"Yaxshisini tanlab bering",reading:"яхшисини танлаб беринг",ru:"Выберите получше",exampleUz:"Iltimos, yaxshisini tanlab bering.",exampleRu:"Пожалуйста, выберите получше."},{topicKey:"bazaar",imageUrl:g.bazaar,uz:"Yarim kilo ham bo‘ladimi?",reading:"ярим кило хам булади ми",ru:"Можно полкило?",exampleUz:"Pomidorlardan yarim kilo ham bo‘ladimi?",exampleRu:"Можно полкило помидоров?"},{topicKey:"bazaar",imageUrl:g.bazaar,uz:"Tarozida tortib bering",reading:"тарозида тортиб беринг",ru:"Взвесьте на весах",exampleUz:"Iltimos, tarozida tortib bering.",exampleRu:"Пожалуйста, взвесьте на весах."},{topicKey:"bazaar",imageUrl:g.bazaar,uz:"Bu juda qimmat ekan",reading:"бу жуда киммат экан",ru:"Это очень дорого",exampleUz:"Aka, bu juda qimmat ekan, arzonroq qiling.",exampleRu:"Это очень дорого, сделайте дешевле."},{topicKey:"bazaar",imageUrl:g.bazaar,uz:"Mayli, ikki kilo oling",reading:"майли икки кило олинг",ru:"Ладно, возьму два кило",exampleUz:"Mayli, olmalardan ikki kilo oling.",exampleRu:"Ладно, возьму два кило яблок."},{topicKey:"city",imageUrl:g.city,uz:"Bekat qayerda?",reading:"бекат қаерда",ru:"Где остановка?",exampleUz:"Shu avtobus bekati qayerda?",exampleRu:"Где эта автобусная остановка?"},{topicKey:"city",imageUrl:g.city,uz:"Shahar markaziga boradimi?",reading:"шаҳар марказига борадими",ru:"Едет в центр города?",exampleUz:"Bu marshrutka shahar markaziga boradimi?",exampleRu:"Эта маршрутка едет в центр?"},{topicKey:"city",imageUrl:g.city,uz:"Shu yerda tushaman",reading:"шу ерда тушаман",ru:"Я выхожу здесь",exampleUz:"Rahmat, shu yerda tushaman.",exampleRu:"Спасибо, я выхожу здесь."},{topicKey:"city",imageUrl:g.city,uz:"Taksiga tezroq borishim kerak",reading:"таксига тезрок боришим керак",ru:"Мне нужно быстрее доехать на такси",exampleUz:"Ishga kech qoldim, taksiga tezroq borishim kerak.",exampleRu:"Я опаздываю на работу, нужно быстрее доехать на такси."},{topicKey:"city",imageUrl:g.city,uz:"Manzilga qancha vaqtda yetamiz?",reading:"манзилга канча вактда етамиз",ru:"За сколько доедем до адреса?",exampleUz:"Markazdagi manzilga qancha vaqtda yetamiz?",exampleRu:"За сколько доедем до адреса в центре?"},{topicKey:"city",imageUrl:g.city,uz:"Iltimos, shu ko‘chadan buriling",reading:"илтимос шу кочадан бурилинг",ru:"Пожалуйста, поверните на этой улице",exampleUz:"Iltimos, keyingi svetofordan emas, shu ko‘chadan buriling.",exampleRu:"Пожалуйста, поверните на этой улице, не на следующем светофоре."},{topicKey:"city",imageUrl:g.city,uz:"Hisobni ilovada to‘layman",reading:"хисобни иловада тулайман",ru:"Оплачу через приложение",exampleUz:"Rahmat, hisobni ilovada to‘layman.",exampleRu:"Спасибо, оплачу через приложение."},{topicKey:"city",imageUrl:g.city,uz:"Iltimos, konditsionerni yoqing",reading:"илтимос кондиционерни ёкинг",ru:"Пожалуйста, включите кондиционер",exampleUz:"Issiq bo‘lyapti, iltimos, konditsionerni yoqing.",exampleRu:"Жарко, пожалуйста, включите кондиционер."},{topicKey:"city",imageUrl:g.city,uz:"Oynani biroz ochib qo‘ysak bo‘ladimi?",reading:"ойнани бироз очиб койсак булади ми",ru:"Можно немного открыть окно?",exampleUz:"Havo yo‘q ekan, oynani biroz ochib qo‘ysak bo‘ladimi?",exampleRu:"Душно, можно немного открыть окно?"},{topicKey:"city",imageUrl:g.city,uz:"Shu manzilda kutib turing",reading:"шу манзилда кутиб туринг",ru:"Подождите по этому адресу",exampleUz:"Men ikki daqiqada chiqaman, shu manzilda kutib turing.",exampleRu:"Я выйду через две минуты, подождите по этому адресу."},{topicKey:"city",imageUrl:g.city,uz:"Yo‘l tirband ekanmi?",reading:"йол тирбанд эканми",ru:"Пробка на дороге?",exampleUz:"Bugun markaz tomonda yo‘l tirband ekanmi?",exampleRu:"Сегодня в сторону центра пробка?"},{topicKey:"city",imageUrl:g.city,uz:"Aylanma yo‘ldan borsak tezroq bo‘ladimi?",reading:"айланма йулдан борсак тезрок булади ми",ru:"По объездной будет быстрее?",exampleUz:"Aylanma yo‘ldan borsak tezroq bo‘ladimi?",exampleRu:"По объездной будет быстрее?"},{topicKey:"city",imageUrl:g.city,uz:"Shu yerda to‘xtab turing",reading:"шу ерда тохтаб туринг",ru:"Остановитесь здесь",exampleUz:"Do‘kon oldida, shu yerda to‘xtab turing.",exampleRu:"У магазина, остановитесь здесь."},{topicKey:"neighbors",imageUrl:g.neighbors,uz:"Bugun havo issiq ekan",reading:"бугун ҳаво иссиқ экан",ru:"Сегодня жаркая погода",exampleUz:"Bugun havo issiq ekan, to‘g‘rimi?",exampleRu:"Сегодня жарко, правда?"},{topicKey:"neighbors",imageUrl:g.neighbors,uz:"Ishlar qalay?",reading:"ишлар қалай",ru:"Как дела?",exampleUz:"Assalomu alaykum, ishlar qalay?",exampleRu:"Здравствуйте, как дела?"},{topicKey:"neighbors",imageUrl:g.neighbors,uz:"Uyda hamma tinchmi?",reading:"уйда ҳамма тинчми",ru:"Дома все в порядке?",exampleUz:"Qo‘shni, uyda hamma tinchmi?",exampleRu:"Сосед, дома все в порядке?"},{topicKey:"neighbors",imageUrl:g.neighbors,uz:"Kechqurun choyga kiring",reading:"кечкирун чойга киринг",ru:"Зайдите вечером на чай",exampleUz:"Qo‘shni, kechqurun choyga kiring.",exampleRu:"Сосед, заходите вечером на чай."},{topicKey:"neighbors",imageUrl:g.neighbors,uz:"Bolalar hovlida o‘ynayapti",reading:"болалар ховлида уйнаяпти",ru:"Дети играют во дворе",exampleUz:"Bugun bolalar hovlida o‘ynayapti.",exampleRu:"Сегодня дети играют во дворе."},{topicKey:"neighbors",imageUrl:g.neighbors,uz:"Ertaga suv o‘chadimi?",reading:"эртага сув очадими",ru:"Завтра отключат воду?",exampleUz:"Qo‘shni, ertaga suv o‘chadimi?",exampleRu:"Сосед, завтра отключат воду?"},{topicKey:"neighbors",imageUrl:g.neighbors,uz:"Yordam kerak bo‘lsa, ayting",reading:"ёрдам керак болса айтинг",ru:"Если нужна помощь, скажите",exampleUz:"Ko‘chishda yordam kerak bo‘lsa, ayting.",exampleRu:"Если нужна помощь с переездом, скажите."},{topicKey:"family",imageUrl:g.family,uz:"Tabriklayman!",reading:"табриклайман",ru:"Поздравляю!",exampleUz:"Farzandingiz tug‘ilibdi, tabriklayman!",exampleRu:"У вас родился ребенок, поздравляю!"},{topicKey:"family",imageUrl:g.family,uz:"O‘g‘ilmi yo qizmi?",reading:"ўғилми ё қизми",ru:"Мальчик или девочка?",exampleUz:"Yangi tug‘ilgan bola o‘g‘ilmi yo qizmi?",exampleRu:"Новорожденный мальчик или девочка?"},{topicKey:"family",imageUrl:g.family,uz:"Baxtli bo‘linglar",reading:"бахтли бўлинглар",ru:"Будьте счастливы",exampleUz:"Oilangiz bilan baxtli bo‘linglar.",exampleRu:"Будьте счастливы с вашей семьей."}];function ni(a,i,s,r=i,o=s){return{topicKey:a,imageUrl:g[a]||null,uz:i,reading:i,ru:s,exampleUz:r,exampleRu:o}}const oi={store:[["Bu mahsulot yangi","Этот товар новый"],["Bu mahsulot eski","Этот товар старый"],["Bu narx qimmat","Эта цена высокая"],["Bu narx arzon","Эта цена низкая"],["Menga sumka kerak","Мне нужен пакет"],["Yana bitta sumka bering","Дайте еще один пакет"],["Qaytim bering, iltimos","Дайте сдачу, пожалуйста"]],bazaar:[["Yarim kilo bering","Дайте полкило"],["Ikki kilo bering","Дайте два килограмма"],["Tarozida tortib bering","Взвесьте на весах"],["Bu meva shirin","Этот фрукт сладкий"],["Bu meva nordon","Этот фрукт кислый"],["Bu sabzavot yangi","Этот овощ свежий"],["Bu juda qimmat","Это очень дорого"],["Mayli, olaman","Ладно, беру"]],city:[["Yo‘l tirbandmi?","Есть пробка на дороге?"],["Aylanma yo‘ldan borsak tezroq bo‘ladimi?","По объездной будет быстрее?"]],neighbors:[["Kechqurun choyga kiring","Зайдите вечером на чай"],["Bolalar hovlida o‘ynayapti","Дети играют во дворе"],["Ertaga suv bo‘ladimi?","Завтра будет вода?"],["Bugun shamol kuchli","Сегодня сильный ветер"],["Bugun yomg‘ir bo‘ladimi?","Сегодня будет дождь?"],["Yordam kerak bo‘lsa, ayting","Если нужна помощь, скажите"],["Hamma yaxshi, rahmat","Все хорошо, спасибо"],["Qo‘shni, savol bor","Сосед, есть вопрос"]],family:[["Ota va ona uyda","Отец и мать дома"],["Aka ishda, opa uyda","Старший брат на работе, сестра дома"],["Bugun tug‘ilgan kun","Сегодня день рождения"],["Oila bilan bayram qilamiz","Празднуем с семьей"],["Farzand yaxshi, sog‘liq yaxshi","Ребенок в порядке, здоровье хорошее"],["Bolaga yordam kerak","Ребенку нужна помощь"],["O‘g‘il maktabda","Сын в школе"],["Qiz uyda","Дочь дома"],["Oilangizga rahmat","Спасибо вашей семье"],["Baxt va tinchlik tilayman","Желаю счастья и спокойствия"],["Kechqurun oila bilan choy","Вечером чай с семьей"],["Bugun hamma birga","Сегодня все вместе"]],pharmacy:[["Assalomu alaykum, yordam kerak","Здравствуйте, нужна помощь"],["Menga sog‘liq uchun dori kerak","Мне нужно лекарство для здоровья"],["Bosh og‘riq uchun dori bormi?","Есть лекарство от головной боли?"],["Yo‘tal uchun nima bor?","Что есть от кашля?"],["Harorat yuqori, nima qilish kerak?","Температура высокая, что делать?"],["Bu dori qachon ichiladi?","Когда принимать это лекарство?"],["Kuniga necha marta ichaman?","Сколько раз в день принимать?"],["Ovqatdan oldinmi yoki keyinmi?","До еды или после?"],["Bolaga ham bo‘ladimi?","Подойдет и ребенку?"],["Yana arzonroq variant bormi?","Есть вариант дешевле?"],["Retsept kerakmi?","Нужен рецепт?"],["Karta qabul qilasizmi?","Принимаете карту?"],["Naqd to‘lasam bo‘ladimi?","Можно оплатить наличными?"],["Rahmat, shu dorini olaman","Спасибо, беру это лекарство"],["Sog‘ bo‘ling","Будьте здоровы"]],clinic:[["Assalomu alaykum, ro‘yxatga yozilmoqchiman","Здравствуйте, хочу записаться"],["Bugun qabul bormi?","Сегодня есть прием?"],["Shifokor qachon bo‘sh bo‘ladi?","Когда врач будет свободен?"],["Navbat qayerda?","Где очередь?"],["Soat nechida kiraman?","Во сколько я зайду?"],["Menda harorat bor","У меня температура"],["Menda yo‘tal bor","У меня кашель"],["Menda bosh og‘riq bor","У меня болит голова"],["Qon tahlili kerakmi?","Нужен анализ крови?"],["Bugun natija bo‘ladimi?","Результат будет сегодня?"],["Ma’lumotnoma berasizmi?","Выдадите справку?"],["Keyingi qabul qachon?","Когда следующий прием?"],["Iltimos, tezroq bo‘lsa yaxshi","Пожалуйста, если можно побыстрее"],["Rahmat, tushundim","Спасибо, понял"],["Xayr, salomat bo‘ling","До свидания, будьте здоровы"]],cafe:[["Bo‘sh stol bormi?","Есть свободный стол?"],["Menyu bering, iltimos","Дайте меню, пожалуйста"],["Menga choy kerak","Мне нужен чай"],["Menga osh kerak","Мне нужен плов"],["Bu taom achchiqmi?","Это блюдо острое?"],["Achchiq bo‘lmasa yaxshi","Лучше не острое"],["Shakar bilan choy bering","Дайте чай с сахаром"],["Suv ham bering","И воду тоже"],["Yana bitta non bering","Дайте еще один хлеб"],["Qancha turadi?","Сколько стоит?"],["Hisobni bering, iltimos","Принесите счет, пожалуйста"],["Karta qabul qilasizmi?","Принимаете карту?"],["Naqd to‘layman","Оплачу наличными"],["Hammasi yaxshi, rahmat","Все хорошо, спасибо"],["Yana kelaman","Приду еще"]],housing:[["Uy ijaraga kerak","Нужно жилье в аренду"],["Bu uy katta","Этот дом большой"],["Bu uy kichik","Этот дом маленький"],["Manzil markazga yaqinmi?","Адрес близко к центру?"],["Ijara narxi qancha?","Сколько аренда?"],["Suv bor, elektr bor","Вода есть, электричество есть"],["Bugun suv yo‘q","Сегодня воды нет"],["Issiq suv qachon bo‘ladi?","Когда будет горячая вода?"],["Kalit bormi?","Есть ключ?"],["Qo‘shnilar tinchmi?","Соседи спокойные?"],["Ta’mir kerak bo‘lsa, kimga aytamiz?","Если нужен ремонт, кому сказать?"],["Xona toza va yaxshi","Комната чистая и хорошая"],["Bugun ko‘rishga kelsam bo‘ladimi?","Можно прийти посмотреть сегодня?"],["Mayli, shu uy menga mos","Хорошо, этот дом мне подходит"],["Shartnoma qachon qilamiz?","Когда оформим договор?"]],taxi:[["Taksi kerak, iltimos","Нужно такси, пожалуйста"],["Manzilga tezroq boraylik","Давайте быстрее доедем до адреса"],["Yo‘l tirband ekan","Похоже, на дороге пробка"],["Boshqa yo‘ldan borsak bo‘ladimi?","Можно поехать другой дорогой?"],["Aylanma yo‘l yaxshiroqmi?","Объездная лучше?"],["Shu yerda bir daqiqa kuting","Подождите здесь одну минуту"],["Oldin do‘konga, keyin uyga","Сначала в магазин, потом домой"],["Yana bitta manzil bor","Есть еще один адрес"],["Shu ko‘chadan o‘ngga buriling","Поверните направо на этой улице"],["Keyin chapga buriling","Потом поверните налево"],["Shu yerda to‘xtang","Остановитесь здесь"],["Qancha bo‘ldi?","Сколько вышло?"],["Hisobni ilovada to‘layman","Оплачу через приложение"],["Rahmat, yaxshi haydadingiz","Спасибо, хорошо вели"],["Xayr, yaxshi kun","До свидания, хорошего дня"]],transport:[["Bekat qayerda?","Где остановка?"],["Bu avtobus markazga boradimi?","Этот автобус едет в центр?"],["Metro kirish qayerda?","Где вход в метро?"],["Qaysi yo‘nalish kerak?","Какой маршрут нужен?"],["Keyingi bekat qaysi?","Какая следующая остановка?"],["Bu yerda tushaman","Я выхожу здесь"],["Bir bekat oldin ayting","Скажите за одну остановку"],["Qayta o‘tish kerakmi?","Нужна пересадка?"],["Marshrutka tezroqmi?","Маршрутка быстрее?"],["Metro sekinroq, lekin arzon","Метро медленнее, но дешевле"],["Yo‘l haqi qancha?","Сколько стоит проезд?"],["Karta bilan to‘lash mumkinmi?","Можно оплатить картой?"],["Bugun transport kechikdimi?","Сегодня транспорт задержался?"],["Rahmat, tushundim","Спасибо, понял"],["Xayr, yaxshi yo‘l","До свидания, счастливого пути"]],work:[["Bugun ish bor","Сегодня есть работа"],["Soat nechida boshlaymiz?","Во сколько начинаем?"],["Men biroz kech qolaman","Я немного опоздаю"],["Bugun yig‘ilish bormi?","Сегодня есть встреча?"],["Vazifa nima?","Какая задача?"],["Hujjat tayyormi?","Документ готов?"],["Bu ish muhim","Эта работа важная"],["Bu ish tez kerak","Эта работа нужна срочно"],["Men tushundim, qilaman","Я понял, сделаю"],["Yordam kerak bo‘lsa ayting","Если нужна помощь, скажите"],["Tanaffus qachon?","Когда перерыв?"],["Bugun vaqt kam","Сегодня мало времени"],["Ertaga davom etamiz","Завтра продолжим"],["Rahmat, yaxshi ishladik","Спасибо, хорошо поработали"],["Xayr, ertaga ko‘rishamiz","До свидания, увидимся завтра"]],bank:[["Bank qayerda?","Где банк?"],["Menga karta kerak","Мне нужна карта"],["Karta ishlamayapti","Карта не работает"],["Pul yechmoqchiman","Хочу снять деньги"],["Pul o‘tkazmoqchiman","Хочу сделать перевод"],["Komissiya qancha?","Какая комиссия?"],["Balansni tekshirib bering","Проверьте баланс"],["Naqd pul bormi?","Есть наличные деньги?"],["Terminal ishlayaptimi?","Терминал работает?"],["To‘lov o‘tmadi","Платеж не прошел"],["Yana bir marta urinib ko‘raylik","Давайте попробуем еще раз"],["Pasport kerakmi?","Нужен паспорт?"],["Imzo qayerga qo‘yaman?","Где поставить подпись?"],["Rahmat, hammasi tushunarli","Спасибо, все понятно"],["Xayr, yaxshi kun","До свидания, хорошего дня"]],school:[["Bola bog‘chada","Ребенок в садике"],["Bola maktabda","Ребенок в школе"],["Dars soat nechida?","Во сколько урок?"],["Bugun ota-ona yig‘ilishi bormi?","Сегодня есть родительское собрание?"],["Ustoz bilan gaplashmoqchiman","Хочу поговорить с учителем"],["Uyga vazifa bormi?","Есть домашнее задание?"],["Bola bugun sal kasal","Ребенок сегодня немного болеет"],["Ma’lumotnoma kerak","Нужна справка"],["Ertaga dars bo‘ladimi?","Завтра будут занятия?"],["Sinf qayerda?","Где класс?"],["Maktabga yaqin uy kerak","Нужно жилье рядом со школой"],["Bola yaxshi o‘qiyapti","Ребенок хорошо учится"],["Rahmat, ustoz","Спасибо, учитель"],["Kechqurun qayta gaplashamiz","Вечером еще поговорим"],["Xayr, ko‘rishguncha","До свидания, до встречи"]],repair:[["Telefon ishlamayapti","Телефон не работает"],["Ta’mir kerak","Нужен ремонт"],["Qachon tayyor bo‘ladi?","Когда будет готово?"],["Bu ish qancha turadi?","Сколько это стоит?"],["Bugun topshirsam bo‘ladimi?","Можно сдать сегодня?"],["Ertaga olib ketsam bo‘ladimi?","Можно забрать завтра?"],["Kafolat bormi?","Есть гарантия?"],["Original detal bormi?","Есть оригинальная деталь?"],["Arzonroq variant bormi?","Есть вариант дешевле?"],["Iltimos, tezroq qiling","Пожалуйста, сделайте быстрее"],["Oldin tekshirib bering","Сначала проверьте"],["Muammo nimada?","В чем проблема?"],["Rahmat, yaxshi bo‘ldi","Спасибо, получилось хорошо"],["To‘lovni karta bilan qilaman","Оплачу картой"],["Xayr, yana kelaman","До свидания, приду снова"]],delivery:[["Posilka qayerda?","Где посылка?"],["Kuryer qachon keladi?","Когда приедет курьер?"],["Manzilni to‘g‘ri yozdimmi?","Я правильно указал адрес?"],["Manzilni qayta aytaman","Сейчас повторю адрес"],["Uy oldida kuting, iltimos","Подождите у дома, пожалуйста"],["Telefon qilsangiz yaxshi","Лучше позвоните"],["Topshirish kodi bor","Есть код получения"],["Olib ketish joyi qayerda?","Где пункт самовывоза?"],["Bugun olib ketsam bo‘ladimi?","Можно забрать сегодня?"],["To‘lov oldindan qilingan","Оплата сделана заранее"],["Naqd to‘lasam ham bo‘ladimi?","Можно оплатить наличными?"],["Posilka butunmi?","Посылка целая?"],["Rahmat, oldim","Спасибо, получил"],["Yana yetkazib berish kerak bo‘ladi","Еще понадобится доставка"],["Xayr, yaxshi kun","До свидания, хорошего дня"]],documents:[["Ro‘yxatdan o‘tmoqchiman","Хочу зарегистрироваться"],["Qaysi hujjat kerak?","Какой документ нужен?"],["Pasport nusxasi kerakmi?","Нужна копия паспорта?"],["Aslini ham olib kelaymi?","Оригинал тоже принести?"],["Ariza qayerda yoziladi?","Где заполняется заявление?"],["Imzo qayerga qo‘yiladi?","Где ставится подпись?"],["Navbat raqami qayerda?","Где номер очереди?"],["Mening navbatim qachon?","Когда моя очередь?"],["Bugun topshirsam bo‘ladimi?","Можно подать сегодня?"],["Natija qachon chiqadi?","Когда будет результат?"],["Ma’lumotnoma tayyormi?","Справка готова?"],["Bitta nusxa bering","Дайте один экземпляр"],["Yana qanday qog‘oz kerak?","Какие еще бумаги нужны?"],["Rahmat, hammasi tushunarli","Спасибо, все понятно"],["Xayr, yaxshi kun","До свидания, хорошего дня"]]},li=Object.entries(oi).flatMap(([a,i])=>i.map(([s,r,o,m])=>ni(a,s,r,o||s,m||r))),ga=[...ri,...li],$a=15,Ja=ga.reduce((a,i)=>(a[i.topicKey]=(a[i.topicKey]||0)+1,a),{});lt.forEach(a=>{if((Ja[a.key]||0)!==$a)throw new Error(`Topic "${a.key}" must have exactly ${$a} phrases, got ${Ja[a.key]||0}`)});const ci=[[1,"neighbors","ha","ха","да"],[1,"neighbors","yo‘q","йок","нет"],[1,"neighbors","men","мен","я"],[1,"neighbors","sen","сен","ты"],[1,"neighbors","siz","сиз","вы"],[1,"neighbors","u","у","он/она"],[1,"neighbors","biz","биз","мы"],[1,"neighbors","ular","улар","они"],[1,"neighbors","bu","бу","это"],[1,"neighbors","ana","ана","вон тот"],[1,"neighbors","qayerda","каерда","где"],[1,"neighbors","qachon","качон","когда"],[1,"neighbors","nega","нега","почему"],[1,"neighbors","kim","ким","кто"],[1,"neighbors","nima","нима","что"],[1,"neighbors","qanday","кандай","как/какой"],[1,"neighbors","bugun","бугун","сегодня"],[1,"neighbors","ertaga","ертага","завтра"],[1,"neighbors","kecha","кеча","вчера"],[1,"neighbors","hozir","хозир","сейчас"],[1,"neighbors","ertalab","эрталаб","утром"],[1,"neighbors","kechqurun","кечкирун","вечером"],[1,"neighbors","kun","кун","день"],[1,"neighbors","hafta","хафта","неделя"],[1,"neighbors","oy","ой","месяц"],[1,"neighbors","yil","йил","год"],[1,"neighbors","bir","бир","один"],[1,"neighbors","ikki","икки","два"],[1,"neighbors","uch","уч","три"],[1,"neighbors","to‘rt","торт","четыре"],[1,"neighbors","besh","беш","пять"],[1,"neighbors","olti","олти","шесть"],[1,"neighbors","yetti","етти","семь"],[1,"neighbors","sakkiz","саккиз","восемь"],[1,"neighbors","to‘qqiz","токкиз","девять"],[1,"neighbors","o‘n","он","десять"],[1,"neighbors","rahmat","рахмат","спасибо"],[1,"neighbors","iltimos","илтимос","пожалуйста"],[1,"neighbors","kechirasiz","кечирасиз","извините"],[1,"neighbors","salom","салом","привет"],[2,"store","non","нон","хлеб"],[2,"store","sut","сут","молоко"],[2,"store","suv","сув","вода"],[2,"store","choy","чой","чай"],[2,"store","qahva","кахва","кофе"],[2,"store","tuz","туз","соль"],[2,"store","shakar","шакар","сахар"],[2,"store","guruch","гуруч","рис"],[2,"store","go‘sht","гошт","мясо"],[2,"store","tovuq","товук","курица"],[2,"store","baliq","балик","рыба"],[2,"store","yog‘","йог","масло"],[2,"store","tuxum","тухум","яйцо"],[2,"store","pishloq","пишлок","сыр"],[2,"store","qatiq","катик","кефир"],[2,"store","do‘kon","докон","магазин"],[2,"store","sotuvchi","сотувчи","продавец"],[2,"store","narx","нарх","цена"],[2,"store","pul","пул","деньги"],[2,"store","naqd","накд","наличные"],[2,"store","karta","карта","карта"],[2,"store","sumka","сумка","сумка"],[2,"store","kiyim","кийим","одежда"],[2,"store","ko‘ylak","койлак","рубашка"],[2,"store","shim","шим","брюки"],[2,"store","oyoq-kiyim","оёк-кийим","обувь"],[2,"store","katta","катта","большой"],[2,"store","kichik","кичик","маленький"],[2,"store","yangi","янги","новый"],[2,"store","eski","эски","старый"],[2,"store","yaxshi","яхши","хороший"],[2,"store","yomon","ёмон","плохой"],[2,"store","qimmat","киммат","дорогой"],[2,"store","arzon","арзон","дешевый"],[2,"store","toza","тоза","чистый"],[2,"store","iflos","ифлос","грязный"],[3,"bazaar","olma","олма","яблоко"],[3,"bazaar","nok","нок","груша"],[3,"bazaar","banan","банан","банан"],[3,"bazaar","uzum","узум","виноград"],[3,"bazaar","shaftoli","шафтоли","персик"],[3,"bazaar","o‘rik","урик","абрикос"],[3,"bazaar","tarvuz","тарвуз","арбуз"],[3,"bazaar","qovun","ковун","дыня"],[3,"bazaar","pomidor","помидор","помидор"],[3,"bazaar","bodring","бодринг","огурец"],[3,"bazaar","piyoz","пиёз","лук"],[3,"bazaar","kartoshka","картошка","картофель"],[3,"bazaar","sabzi","сабзи","морковь"],[3,"bazaar","karam","карам","капуста"],[3,"bazaar","qalampir","калампир","перец"],[3,"bazaar","sarimsoq","саримсок","чеснок"],[3,"bazaar","ko‘kat","кокат","зелень"],[3,"bazaar","meva","мева","фрукты"],[3,"bazaar","sabzavot","сабзавот","овощи"],[3,"bazaar","bozor","бозор","базар"],[3,"bazaar","tarozi","тарози","весы"],[3,"bazaar","kilo","кило","килограмм"],[3,"bazaar","yarim","ярим","половина"],[3,"bazaar","dona","дона","штука"],[3,"bazaar","yaxshiroq","яхширок","получше"],[3,"bazaar","pishgan","пишган","спелый"],[3,"bazaar","xom","хом","незрелый"],[3,"bazaar","shirin","ширин","сладкий"],[3,"bazaar","nordon","нордон","кислый"],[3,"bazaar","achchiq","аччик","острый"],[3,"bazaar","yumshoq","юмшок","мягкий"],[3,"bazaar","qattiq","каттик","твердый"],[4,"city","uy","уй","дом"],[4,"city","ko‘cha","коча","улица"],[4,"city","mahalla","махалла","квартал/махалля"],[4,"city","shahar","шахар","город"],[4,"city","markaz","марказ","центр"],[4,"city","bekat","бекат","остановка"],[4,"city","avtobus","автобус","автобус"],[4,"city","metro","метро","метро"],[4,"city","marshrutka","маршрутка","маршрутка"],[4,"city","taksi","такси","такси"],[4,"city","yo‘l","йол","дорога"],[4,"city","burilish","бурилиш","поворот"],[4,"city","o‘ng","онг","право"],[4,"city","chap","чап","лево"],[4,"city","to‘g‘ri","тогри","прямо"],[4,"city","yaqin","якин","близко"],[4,"city","uzoq","узок","далеко"],[4,"city","tez","тез","быстро"],[4,"city","sekin","секин","медленно"],[4,"city","ish","иш","работа"],[4,"city","bo‘sh","бош","свободный"],[4,"city","vaqt","вакт","время"],[4,"city","soat","соат","час"],[4,"city","daqiqa","дакика","минута"],[4,"city","kirish","кириш","вход"],[4,"city","chiqish","чикиш","выход"],[4,"city","past","паст","вниз"],[4,"city","yuqori","юкори","вверх"],[4,"city","oldin","олдин","раньше/впереди"],[4,"city","keyin","кейин","позже/после"],[4,"city","o‘tish","утиш","переход"],[4,"city","manzil","манзил","адрес"],[5,"neighbors","issiq","иссик","жарко"],[5,"neighbors","sovuq","совук","холодно"],[5,"neighbors","salqin","салкин","прохладно"],[5,"neighbors","shamol","шамол","ветер"],[5,"neighbors","yomg‘ir","ёмгир","дождь"],[5,"neighbors","qor","кор","снег"],[5,"neighbors","quyosh","куёш","солнце"],[5,"neighbors","bulut","булут","облако"],[5,"neighbors","osmon","осмон","небо"],[5,"neighbors","ob-havo","об-хаво","погода"],[5,"neighbors","qo‘shni","кошни","сосед"],[5,"neighbors","do‘st","дост","друг"],[5,"neighbors","tanish","таниш","знакомый"],[5,"neighbors","mehmon","мехмон","гость"],[5,"neighbors","yordam","ёрдам","помощь"],[5,"neighbors","savol","савол","вопрос"],[5,"neighbors","javob","жавоб","ответ"],[5,"neighbors","gap","гап","разговор/слово"],[5,"neighbors","til","тил","язык"],[5,"neighbors","o‘rganish","органиш","изучение"],[5,"neighbors","tushunish","тушуниш","понимание"],[5,"neighbors","eslash","эслаш","вспоминать"],[5,"neighbors","aytish","айтиш","сказать"],[5,"neighbors","eshitish","эшитиш","слышать"],[5,"neighbors","ko‘rish","кориш","видеть"],[5,"neighbors","bilish","билиш","знать"],[5,"neighbors","xohlamoq","хохламок","хотеть"],[5,"neighbors","kerak","керак","нужно"],[5,"neighbors","mumkin","мумкин","можно"],[5,"neighbors","bo‘ladi","болади","будет/можно"],[5,"neighbors","bo‘lmaydi","болмайди","нельзя/не будет"],[6,"family","ota","ота","отец"],[6,"family","ona","она","мать"],[6,"family","aka","ака","старший брат"],[6,"family","uka","ука","младший брат"],[6,"family","opa","опа","старшая сестра"],[6,"family","singil","сингил","младшая сестра"],[6,"family","er","эр","муж"],[6,"family","xotin","хотин","жена"],[6,"family","bola","бола","ребенок"],[6,"family","o‘g‘il","огил","сын"],[6,"family","qiz","киз","дочь/девушка"],[6,"family","nabira","набира","внук/внучка"],[6,"family","oila","оила","семья"],[6,"family","to‘y","той","свадьба"],[6,"family","bayram","байрам","праздник"],[6,"family","tabrik","табрик","поздравление"],[6,"family","tug‘ilgan kun","тугилган кун","день рождения"],[6,"family","sog‘liq","соглик","здоровье"],[6,"family","baxt","бахт","счастье"],[6,"family","tinchlik","тинчлик","мир/спокойствие"],[6,"family","ishlamoq","ишламок","работать"],[6,"family","yashamoq","яшамок","жить"],[6,"family","bor","бор","есть/имеется"],[6,"family","yo‘q","йок","нет/отсутствует"],[6,"family","bermoq","бермок","давать"],[6,"family","olmoq","олмок","брать"],[6,"family","kelmoq","келмок","приходить"],[6,"family","bormoq","бормок","идти/ехать"],[6,"family","o‘tirmoq","утирмок","сидеть"],[6,"family","turmoq","турмок","стоять/жить"],[6,"family","uxlamoq","ухламок","спать"],[6,"family","ovqat","овкат","еда"]],pa=ci.map(([a,i,s,r,o])=>({level:a,topicKey:i,uz:s,reading:r,ru:o})),di=[{uz:"bu {uz}",ru:"это {ru}",levelBoost:0},{uz:"yangi {uz}",ru:"новый {ru}",levelBoost:0},{uz:"katta {uz}",ru:"большой {ru}",levelBoost:1},{uz:"kichik {uz}",ru:"маленький {ru}",levelBoost:1},{uz:"{uz} bor",ru:"есть {ru}",levelBoost:2},{uz:"{uz} yo‘q",ru:"нет {ru}",levelBoost:2},{uz:"{uz} kerak",ru:"нужен {ru}",levelBoost:3},{uz:"{uz} qayerda?",ru:"где {ru}?",levelBoost:3},{uz:"menga {uz} kerak",ru:"мне нужен {ru}",levelBoost:4},{uz:"bizga {uz} kerak",ru:"нам нужен {ru}",levelBoost:4},{uz:"shu {uz} yaxshi",ru:"этот {ru} хороший",levelBoost:5},{uz:"shu {uz} yomon",ru:"этот {ru} плохой",levelBoost:5}],ui=pa.filter(a=>!a.uz.includes(" "));function mi(a){const i=[];return a.forEach(s=>{di.forEach(r=>{const o=Math.min(18,Math.max(7,Number(s.level)+5+r.levelBoost));i.push({level:o,topicKey:s.topicKey,uz:r.uz.replace("{uz}",s.uz),reading:r.uz.replace("{uz}",s.reading),ru:r.ru.replace("{ru}",s.ru)})})}),i}const ct=mi(ui),dt=[{level:2,topicKey:"neighbors",uz:"assalomu",reading:"ассалому",ru:"мир вам"},{level:2,topicKey:"neighbors",uz:"alaykum",reading:"алейкум",ru:"и вам мир"},{level:2,topicKey:"store",uz:"bering",reading:"беринг",ru:"дайте"},{level:2,topicKey:"store",uz:"bormi",reading:"борми",ru:"есть ли"},{level:2,topicKey:"store",uz:"qancha",reading:"канча",ru:"сколько"},{level:2,topicKey:"store",uz:"turadi",reading:"туради",ru:"стоит"},{level:3,topicKey:"store",uz:"arzonroq",reading:"арзонрок",ru:"подешевле"},{level:3,topicKey:"store",uz:"qabul",reading:"қабул",ru:"прием"},{level:3,topicKey:"store",uz:"qilasizmi",reading:"қиласизми",ru:"вы делаете?"},{level:3,topicKey:"store",uz:"iloji",reading:"иложи",ru:"возможность"},{level:3,topicKey:"store",uz:"bo‘lsa",reading:"болса",ru:"если будет"},{level:3,topicKey:"store",uz:"yoki",reading:"ёки",ru:"или"},{level:3,topicKey:"store",uz:"faqat",reading:"фақат",ru:"только"},{level:3,topicKey:"store",uz:"naqdmi",reading:"накдми",ru:"наличными?"},{level:3,topicKey:"bazaar",uz:"va",reading:"ва",ru:"и"},{level:3,topicKey:"neighbors",uz:"shu",reading:"шу",ru:"этот/эта"},{level:3,topicKey:"bazaar",uz:"yaxshisini",reading:"яхшисини",ru:"лучший (вин.)"},{level:3,topicKey:"bazaar",uz:"tanlab",reading:"танлаб",ru:"выбрав"},{level:3,topicKey:"bazaar",uz:"pomidordan",reading:"помидордан",ru:"из помидоров"},{level:4,topicKey:"city",uz:"markaziga",reading:"марказига",ru:"в центр"},{level:4,topicKey:"city",uz:"boradimi",reading:"борадими",ru:"идет ли/едет ли"},{level:4,topicKey:"city",uz:"yerda",reading:"ерда",ru:"здесь/в месте"},{level:4,topicKey:"city",uz:"tushaman",reading:"тушаман",ru:"выхожу"},{level:4,topicKey:"city",uz:"bekati",reading:"бекати",ru:"остановка (его)"},{level:5,topicKey:"neighbors",uz:"havo",reading:"ҳаво",ru:"воздух/погода"},{level:5,topicKey:"neighbors",uz:"ekan",reading:"экан",ru:"оказывается"},{level:5,topicKey:"neighbors",uz:"ishlar",reading:"ишлар",ru:"дела"},{level:5,topicKey:"neighbors",uz:"qalay",reading:"қалай",ru:"как"},{level:5,topicKey:"neighbors",uz:"uyda",reading:"уйда",ru:"дома"},{level:5,topicKey:"neighbors",uz:"hamma",reading:"ҳамма",ru:"все"},{level:5,topicKey:"neighbors",uz:"tinchmi",reading:"тинчми",ru:"все спокойно?"},{level:5,topicKey:"neighbors",uz:"to‘g‘rimi",reading:"тўғрими",ru:"правильно?"},{level:6,topicKey:"family",uz:"tabriklayman",reading:"табриклайман",ru:"поздравляю"},{level:6,topicKey:"family",uz:"o‘g‘ilmi",reading:"ўғилми",ru:"мальчик?"},{level:6,topicKey:"family",uz:"yo",reading:"ё",ru:"или"},{level:6,topicKey:"family",uz:"qizmi",reading:"қизми",ru:"девочка?"},{level:6,topicKey:"family",uz:"baxtli",reading:"бахтли",ru:"счастливый"},{level:6,topicKey:"family",uz:"bo‘linglar",reading:"бўлинглар",ru:"будьте (мн.)"},{level:6,topicKey:"family",uz:"farzandingiz",reading:"фарзандингиз",ru:"ваш ребенок"},{level:6,topicKey:"family",uz:"tug‘ilibdi",reading:"туғилибди",ru:"родился/родилась"},{level:6,topicKey:"family",uz:"tug‘ilgan",reading:"туғилган",ru:"рожденный"},{level:6,topicKey:"family",uz:"oilangiz",reading:"оилангиз",ru:"ваша семья"},{level:6,topicKey:"family",uz:"bilan",reading:"билан",ru:"с"}];function Va(a){return(a.toLowerCase().match(/[a-z\u00c0-\u024f\u0400-\u04ffʻ’'`-]+/gi)||[]).map(i=>i.toLowerCase())}function hi(a,i){const s=new Set;i.forEach(o=>{Va(o.uz).forEach(m=>s.add(m))});const r=new Map;return a.forEach(o=>{const m=`${o.uz} ${o.exampleUz}`;Va(m).forEach(d=>{!s.has(d)&&!r.has(d)&&r.set(d,{level:7,topicKey:o.topicKey,uz:d,reading:d,ru:d})})}),Array.from(r.values())}const gi=hi(ga,[...pa,...ct,...dt]),ma=new Map;[...pa,...ct,...dt,...gi].forEach(a=>{const i=a.uz+"::"+a.ru;ma.has(i)||ma.set(i,a)});const pi=Array.from(ma.values()),Me="uzlang-db-v1";let na,$;function Q(a=new Date){return new Date(a.getFullYear(),a.getMonth(),a.getDate()).toISOString().slice(0,10)}function ut(a,i){const s=new Date(a);return s.setDate(s.getDate()+i),Q(s)}function fe(a,i){const s=new Date(a);return s.setDate(s.getDate()+i),s}function yi(a){const i=[],r=fe(new Date,-(a-1));for(let o=0;o<a;o+=1)i.push(Q(fe(r,o)));return i}function xi(a){const i=a.getUTCDay()||7,s=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()));return s.setUTCDate(s.getUTCDate()-i+1),s}function mt(a){const i=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()));i.setUTCDate(i.getUTCDate()+4-(i.getUTCDay()||7));const s=new Date(Date.UTC(i.getUTCFullYear(),0,1)),r=Math.ceil(((i-s)/864e5+1)/7);return i.getUTCFullYear()+"-W"+String(r).padStart(2,"0")}function bi(a){const i=[],r=xi(new Date);for(let o=a-1;o>=0;o-=1){const m=fe(r,-o*7);i.push({key:mt(m),label:m.toISOString().slice(5,10),startDate:m.toISOString().slice(0,10)})}return i}async function ht(){return na||(na=ii({locateFile:()=>si})),na}function ve(a){const i=a.export(),s=Array.from(i);localStorage.setItem(Me,JSON.stringify(s))}function te(a,i,s=[]){const r=a.prepare(i);r.bind(s),r.step(),r.free()}function f(a,i,s=[]){const r=a.prepare(i);r.bind(s);const o=[];for(;r.step();)o.push(r.getAsObject());return r.free(),o}function fi(a){a.run(`
    CREATE TABLE IF NOT EXISTS topics (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      topic_key TEXT UNIQUE NOT NULL,
      title TEXT NOT NULL,
      description TEXT NOT NULL
    );

    CREATE TABLE IF NOT EXISTS cards (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      topic_id INTEGER NOT NULL,
      uz TEXT NOT NULL,
      reading TEXT NOT NULL,
      ru TEXT NOT NULL,
      example_uz TEXT NOT NULL,
      example_ru TEXT NOT NULL,
      image_url TEXT,
      FOREIGN KEY (topic_id) REFERENCES topics (id)
    );

    CREATE TABLE IF NOT EXISTS progress (
      card_id INTEGER PRIMARY KEY,
      easiness REAL NOT NULL DEFAULT 2.5,
      interval_days INTEGER NOT NULL DEFAULT 1,
      repetitions INTEGER NOT NULL DEFAULT 0,
      next_review TEXT NOT NULL,
      last_score INTEGER,
      FOREIGN KEY (card_id) REFERENCES cards (id)
    );

    CREATE TABLE IF NOT EXISTS words (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      topic_id INTEGER NOT NULL,
      level INTEGER NOT NULL,
      uz TEXT NOT NULL,
      reading TEXT NOT NULL,
      ru TEXT NOT NULL,
      image_url TEXT,
      FOREIGN KEY (topic_id) REFERENCES topics (id)
    );

    CREATE TABLE IF NOT EXISTS word_progress (
      word_id INTEGER PRIMARY KEY,
      easiness REAL NOT NULL DEFAULT 2.5,
      interval_days INTEGER NOT NULL DEFAULT 1,
      repetitions INTEGER NOT NULL DEFAULT 0,
      next_review TEXT NOT NULL,
      last_score INTEGER,
      FOREIGN KEY (word_id) REFERENCES words (id)
    );

    CREATE TABLE IF NOT EXISTS word_quiz_results (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      level INTEGER NOT NULL,
      score INTEGER NOT NULL,
      total INTEGER NOT NULL,
      is_success INTEGER NOT NULL,
      created_at TEXT NOT NULL
    );

    CREATE TABLE IF NOT EXISTS word_review_events (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      word_id INTEGER NOT NULL,
      score INTEGER NOT NULL,
      created_at TEXT NOT NULL,
      FOREIGN KEY (word_id) REFERENCES words (id)
    );

    CREATE TABLE IF NOT EXISTS word_step_quiz_results (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      step_index INTEGER NOT NULL,
      score INTEGER NOT NULL,
      total INTEGER NOT NULL,
      is_success INTEGER NOT NULL,
      created_at TEXT NOT NULL
    );
    CREATE UNIQUE INDEX IF NOT EXISTS idx_words_unique ON words (uz, ru);
  `)}function vi(a){a.run("BEGIN;"),lt.forEach(r=>{te(a,"INSERT OR IGNORE INTO topics (topic_key, title, description) VALUES (?, ?, ?);",[r.key,r.title,r.description])});const i=f(a,"SELECT id, topic_key FROM topics;"),s=new Map(i.map(r=>[r.topic_key,r.id]));ga.forEach(r=>{te(a,`INSERT INTO cards (topic_id, uz, reading, ru, example_uz, example_ru, image_url)
       SELECT ?, ?, ?, ?, ?, ?, ?
       WHERE NOT EXISTS (
         SELECT 1
         FROM cards
         WHERE topic_id = ? AND uz = ? AND ru = ?
       );`,[s.get(r.topicKey),r.uz,r.reading,r.ru,r.exampleUz,r.exampleRu,r.imageUrl||g[r.topicKey]||null,s.get(r.topicKey),r.uz,r.ru])}),a.run("COMMIT;")}function zi(a){const i=f(a,"SELECT id, topic_key FROM topics;"),s=new Map(i.map(r=>[r.topic_key,r.id]));a.run("BEGIN;"),pi.forEach(r=>{const o=s.get(r.topicKey);o&&te(a,`INSERT OR IGNORE INTO words
        (topic_id, level, uz, reading, ru, image_url)
       VALUES (?, ?, ?, ?, ?, ?);`,[o,Number(r.level),r.uz,r.reading,r.ru,g[r.topicKey]||null])}),a.run("COMMIT;")}function wi(a){Object.entries(g).forEach(([s,r])=>{te(a,`UPDATE cards
       SET image_url = ?
       WHERE image_url IS NULL
         AND topic_id IN (SELECT id FROM topics WHERE topic_key = ?);`,[r,s]),te(a,`UPDATE words
       SET image_url = ?
       WHERE image_url IS NULL
         AND topic_id IN (SELECT id FROM topics WHERE topic_key = ?);`,[r,s])})}async function M(){if($)return $;const a=await ht(),i=localStorage.getItem(Me);return i?$=new a.Database(Uint8Array.from(JSON.parse(i))):$=new a.Database,fi($),vi($),zi($),wi($),ve($),$}async function oa(){const a=await M();return f(a,`SELECT t.id,
            t.topic_key AS topicKey,
            t.title,
            t.description,
            COUNT(w.id) AS totalWords,
            SUM(CASE WHEN wp.repetitions > 0 THEN 1 ELSE 0 END) AS learnedWords
     FROM topics t
     LEFT JOIN words w ON w.topic_id = t.id
     LEFT JOIN word_progress wp ON wp.word_id = w.id
     GROUP BY t.id
     ORDER BY t.id;`).map(s=>{const r=Number(s.totalWords||0),o=Number(s.learnedWords||0);return{id:Number(s.id),topicKey:s.topicKey,title:s.title,description:s.description,totalWords:r,learnedWords:o,unlocked:r===0||o>=r}})}async function ki(a){const i=await M();return f(i,`SELECT id, uz, reading, ru, example_uz AS exampleUz, example_ru AS exampleRu,
            image_url AS imageUrl
     FROM cards
     WHERE topic_id = ?
     ORDER BY id;`,[a])}async function Ei(a=20){const i=await M(),s=Q();return f(i,`SELECT c.id, c.uz, c.reading, c.ru, c.example_uz AS exampleUz, c.example_ru AS exampleRu,
            c.image_url AS imageUrl,
            t.title AS topicTitle,
            p.next_review AS nextReview
     FROM cards c
     JOIN topics t ON c.topic_id = t.id
     LEFT JOIN progress p ON p.card_id = c.id
     WHERE p.next_review IS NULL OR p.next_review <= ?
     ORDER BY COALESCE(p.next_review, ?) ASC, c.id ASC
     LIMIT ?;`,[s,s,a])}async function Ti(a,i=10){const s=await M();return f(s,`SELECT id, uz, reading, ru, example_uz AS exampleUz, example_ru AS exampleRu,
            image_url AS imageUrl
     FROM cards
     WHERE topic_id = ?
     ORDER BY RANDOM()
     LIMIT ?;`,[a,i])}async function Si(a,i){const s=await M(),r=Q(),o=f(s,"SELECT easiness, interval_days AS intervalDays, repetitions FROM progress WHERE card_id = ?;",[a]);let m=2.5,d=1,y=0;o.length>0&&(m=Number(o[0].easiness),d=Number(o[0].intervalDays),y=Number(o[0].repetitions)),i<3?(y=0,d=1):(y+=1,y===1?d=1:y===2?d=3:d=Math.max(1,Math.round(d*m))),m=Math.max(1.3,m+(.1-(5-i)*(.08+(5-i)*.02)));const k=ut(r,d);return te(s,`INSERT INTO progress
      (card_id, easiness, interval_days, repetitions, next_review, last_score)
     VALUES (?, ?, ?, ?, ?, ?)
     ON CONFLICT(card_id) DO UPDATE SET
      easiness = excluded.easiness,
      interval_days = excluded.interval_days,
      repetitions = excluded.repetitions,
      next_review = excluded.next_review,
      last_score = excluded.last_score;`,[a,m,d,y,k,i]),ve(s),{nextReview:k,intervalDays:d,repetitions:y}}async function ji(){const a=await M(),[{total:i}]=f(a,"SELECT COUNT(*) AS total FROM words;"),s=f(a,"SELECT level, COUNT(*) AS count FROM words GROUP BY level ORDER BY level;");return{total:Number(i),byLevel:s.map(r=>({level:Number(r.level),count:Number(r.count)}))}}async function la(a,i=20){const s=await M(),r=Math.max(0,Number(a)||0)*Number(i);return f(s,`SELECT w.id, w.level, w.uz, w.reading, w.ru, w.image_url AS imageUrl,
            t.title AS topicTitle
     FROM words w
     JOIN topics t ON w.topic_id = t.id
     ORDER BY w.id ASC
     LIMIT ?
     OFFSET ?;`,[i,r])}async function Za(a,i=20,s=30){const r=await M(),o=Q(),m=Math.max(0,Number(a)||0)*Number(i);return f(r,`SELECT w.id, w.level, w.uz, w.reading, w.ru, w.image_url AS imageUrl,
            t.title AS topicTitle,
            wp.next_review AS nextReview
     FROM (
       SELECT id, topic_id, level, uz, reading, ru, image_url
       FROM words
       ORDER BY id ASC
       LIMIT ?
       OFFSET ?
     ) w
     JOIN topics t ON w.topic_id = t.id
     LEFT JOIN word_progress wp ON wp.word_id = w.id
     WHERE wp.next_review IS NULL OR wp.next_review <= ?
     ORDER BY COALESCE(wp.next_review, ?) ASC, w.id ASC
     LIMIT ?;`,[i,m,o,o,s])}async function et(a,i=20,s=10){const r=await M(),o=Math.max(0,Number(a)||0)*Number(i);return f(r,`SELECT id, level, uz, reading, ru, image_url AS imageUrl
     FROM (
       SELECT id, level, uz, reading, ru, image_url
       FROM words
       ORDER BY id ASC
       LIMIT ?
       OFFSET ?
     )
     ORDER BY RANDOM()
     LIMIT ?;`,[i,o,s])}async function Ri(a,i){const s=await M(),r=Q(),o=f(s,"SELECT easiness, interval_days AS intervalDays, repetitions FROM word_progress WHERE word_id = ?;",[a]);let m=2.5,d=1,y=0;o.length>0&&(m=Number(o[0].easiness),d=Number(o[0].intervalDays),y=Number(o[0].repetitions)),i<3?(y=0,d=1):(y+=1,y===1?d=1:y===2?d=3:d=Math.max(1,Math.round(d*m))),m=Math.max(1.3,m+(.1-(5-i)*(.08+(5-i)*.02)));const k=ut(r,d);return te(s,`INSERT INTO word_progress
      (word_id, easiness, interval_days, repetitions, next_review, last_score)
     VALUES (?, ?, ?, ?, ?, ?)
     ON CONFLICT(word_id) DO UPDATE SET
      easiness = excluded.easiness,
      interval_days = excluded.interval_days,
      repetitions = excluded.repetitions,
      next_review = excluded.next_review,
      last_score = excluded.last_score;`,[a,m,d,y,k,i]),te(s,"INSERT INTO word_review_events (word_id, score, created_at) VALUES (?, ?, ?);",[a,i,new Date().toISOString()]),ve(s),{nextReview:k,intervalDays:d,repetitions:y}}async function Ni(a){const i=await M(),s=Q(),[{totalWordsLevel:r}]=f(i,"SELECT COUNT(*) AS totalWordsLevel FROM words WHERE level = ?;",[a]),[{learnedWordsLevel:o}]=f(i,`SELECT COUNT(*) AS learnedWordsLevel
     FROM words w
     JOIN word_progress wp ON wp.word_id = w.id
     WHERE w.level = ? AND wp.repetitions > 0;`,[a]),[{masteredWordsLevel:m}]=f(i,`SELECT COUNT(*) AS masteredWordsLevel
     FROM words w
     JOIN word_progress wp ON wp.word_id = w.id
     WHERE w.level = ? AND wp.repetitions >= 2;`,[a]),[{dueWordsLevel:d}]=f(i,`SELECT COUNT(*) AS dueWordsLevel
     FROM words w
     LEFT JOIN word_progress wp ON wp.word_id = w.id
     WHERE w.level = ?
       AND (wp.next_review IS NULL OR wp.next_review <= ?);`,[a,s]),[{learnedWordsTotal:y}]=f(i,"SELECT COUNT(*) AS learnedWordsTotal FROM word_progress WHERE repetitions > 0;"),[{masteredWordsTotal:k}]=f(i,"SELECT COUNT(*) AS masteredWordsTotal FROM word_progress WHERE repetitions >= 2;"),[{totalPhrases:S}]=f(i,"SELECT COUNT(*) AS totalPhrases FROM cards;"),[{learnedPhrases:K}]=f(i,"SELECT COUNT(*) AS learnedPhrases FROM progress WHERE repetitions > 0;"),[{masteredPhrases:T}]=f(i,"SELECT COUNT(*) AS masteredPhrases FROM progress WHERE repetitions >= 2;"),[{duePhrases:D}]=f(i,`SELECT COUNT(*) AS duePhrases
     FROM cards c
     LEFT JOIN progress p ON p.card_id = c.id
     WHERE p.next_review IS NULL OR p.next_review <= ?;`,[s]),[{quizSuccess:F}]=f(i,"SELECT COUNT(*) AS quizSuccess FROM word_quiz_results WHERE level = ? AND is_success = 1;",[a]),[{quizFail:C}]=f(i,"SELECT COUNT(*) AS quizFail FROM word_quiz_results WHERE level = ? AND is_success = 0;",[a]),W=f(i,"SELECT level, SUM(is_success) AS successCount FROM word_quiz_results GROUP BY level;"),p=f(i,"SELECT DISTINCT level FROM words ORDER BY level ASC;"),_=new Map(W.map(U=>[Number(U.level),Number(U.successCount)]));let j=p.length?Number(p[0].level):1;for(let U=0;U<p.length;U+=1){const R=Number(p[U].level);U===0&&(j=R);const z=p[U+1]?Number(p[U+1].level):R;if((_.get(R)||0)>0)j=z;else break}return{level:Number(a),words:{totalLevel:Number(r),learnedLevel:Number(o),masteredLevel:Number(m),dueLevel:Number(d),learnedTotal:Number(y),masteredTotal:Number(k)},phrases:{total:Number(S),learned:Number(K),mastered:Number(T),due:Number(D)},quiz:{success:Number(F),fail:Number(C)},unlockedLevel:Number(j)}}async function Ci(a,i,s){const r=await M(),o=i===10&&s===10?1:0,m=new Date().toISOString();return te(r,`INSERT INTO word_step_quiz_results
      (step_index, score, total, is_success, created_at)
     VALUES (?, ?, ?, ?, ?);`,[a,i,s,o,m]),ve(r),{isSuccess:!!o}}async function gt(a=20){const i=await M(),s=f(i,`SELECT w.id, COALESCE(wp.repetitions, 0) AS repetitions
     FROM words w
     LEFT JOIN word_progress wp ON wp.word_id = w.id
     ORDER BY w.id ASC;`),r=f(i,`SELECT step_index AS stepIndex, SUM(is_success) AS successCount
     FROM word_step_quiz_results
     GROUP BY step_index;`),o=new Map(r.map(T=>[Number(T.stepIndex),Number(T.successCount||0)])),m=s.length,d=Math.max(1,Math.ceil(m/a)),y=[];for(let T=0;T<d;T+=1){const D=T*a,F=s.slice(D,D+a),C=F.length,W=F.filter(z=>Number(z.repetitions)>0).length,p=F.filter(z=>Number(z.repetitions)>=2).length,_=o.get(T)||0,j=C>0?Math.round(W/C*100):0,U=C>0?Math.round(p/C*100):0,R=C>0&&W===C&&_>0;y.push({stepIndex:T,total:C,learned:W,mastered:p,learnedPercent:j,masteredPercent:U,quizSuccess:_,completed:R})}const k=y.find(T=>!T.completed),S=k?k.stepIndex:Math.max(0,d-1),K=y.filter(T=>T.completed).length;return{stepSize:Number(a),totalWords:m,totalSteps:d,activeStepIndex:S,completedSteps:K,steps:y}}async function at(){const a=await M();ve(a);const i=localStorage.getItem(Me),s=i?JSON.parse(i):[];return{app:"UzLang",version:1,exportedAt:new Date().toISOString(),data:s}}async function Ii(){const a=await M(),i=Q(),s=20,r=1,[{wordsDone:o}]=f(a,`SELECT COUNT(*) AS wordsDone
     FROM word_review_events
     WHERE substr(created_at, 1, 10) = ?;`,[i]),[{perfectTestsDone:m}]=f(a,`SELECT COUNT(*) AS perfectTestsDone
     FROM (
       SELECT is_success, created_at FROM word_quiz_results
       UNION ALL
       SELECT is_success, created_at FROM word_step_quiz_results
     )
     WHERE is_success = 1
       AND substr(created_at, 1, 10) = ?;`,[i]),d=Number(o),y=Number(m),k=d>=s&&y>=r,S=f(a,`SELECT substr(created_at, 1, 10) AS day, COUNT(*) AS count
     FROM word_review_events
     GROUP BY day
     ORDER BY day;`),K=f(a,`SELECT substr(created_at, 1, 10) AS day, COUNT(*) AS count
     FROM (
       SELECT is_success, created_at FROM word_quiz_results
       UNION ALL
       SELECT is_success, created_at FROM word_step_quiz_results
     )
     WHERE is_success = 1
     GROUP BY day
     ORDER BY day;`),T=new Map(S.map(z=>[String(z.day),Number(z.count)])),D=new Map(K.map(z=>[String(z.day),Number(z.count)])),F=new Set([...T.keys(),...D.keys()]),C=new Set;F.forEach(z=>{const H=T.get(z)||0,Z=D.get(z)||0;H>=s&&Z>=r&&C.add(z)});let W=0;for(let z=0;z<3650;z+=1){const H=Q(fe(new Date(i),-z));if(C.has(H)){W+=1;continue}break}let p=0,_=0;if(F.size>0){const H=Array.from(F).sort()[0];for(let Z=new Date(H);Q(Z)<=i;Z=fe(Z,1)){const he=Q(Z);C.has(he)?(_+=1,_>p&&(p=_)):_=0}}const j=[3,7,14,30,60,100],U=j.find(z=>z>W)||j[j.length-1],R=Math.min(100,Math.round(Math.max(0,W)/Math.max(1,U)*100));return{date:i,wordsTarget:s,wordsDone:d,wordsCompleted:d>=s,perfectTestsTarget:r,perfectTestsDone:y,perfectTestsCompleted:y>=r,allCompleted:k,streak:{current:W,longest:p,nextMilestone:U,progressPercent:R}}}async function tt(a=14,i=8){var W;const s=await M(),r=yi(a),o=r[0],m=f(s,`SELECT substr(created_at, 1, 10) AS day, COUNT(*) AS count
     FROM word_review_events
     WHERE substr(created_at, 1, 10) >= ?
     GROUP BY day
     ORDER BY day;`,[o]),d=new Map(m.map(p=>[String(p.day),Number(p.count)])),y=r.map(p=>({day:p,label:p.slice(5),count:d.get(p)||0})),k=bi(i),S=((W=k[0])==null?void 0:W.startDate)||Q(),K=f(s,`SELECT created_at
     FROM (
       SELECT is_success, created_at FROM word_quiz_results
       UNION ALL
       SELECT is_success, created_at FROM word_step_quiz_results
     )
     WHERE is_success = 1 AND substr(created_at, 1, 10) >= ?;`,[S]),T=new Map;K.forEach(p=>{const _=new Date(String(p.created_at)),j=mt(_);T.set(j,(T.get(j)||0)+1)});const D=k.map(p=>({weekKey:p.key,label:p.label,count:T.get(p.key)||0})),C=(await gt(20)).steps.map(p=>({level:p.stepIndex+1,total:p.total,learned:p.learned,mastered:p.mastered,learnedPercent:p.learnedPercent,masteredPercent:p.masteredPercent}));return{dailyReviews:y,weeklyPerfectTests:D,levelProgress:C}}async function Oi(a){if(!a||typeof a!="object")throw new Error("Неверный формат файла");if(a.app!=="UzLang"||a.version!==1)throw new Error("Файл не является бэкапом UzLang v1");if(!Array.isArray(a.data)||a.data.length===0)throw new Error("В файле нет данных прогресса");const i=a.data;if(!i.every(k=>Number.isInteger(k)&&k>=0&&k<=255))throw new Error("Поврежденные данные прогресса");const s=await ht(),r=new s.Database(Uint8Array.from(i)),o=["topics","cards","progress","words","word_progress","word_quiz_results"],m=r.exec("SELECT name FROM sqlite_master WHERE type = 'table';"),d=new Set;m.length>0&&(m[0].values||[]).forEach(S=>{Array.isArray(S)&&S[0]&&d.add(String(S[0]))});const y=o.filter(k=>!d.has(k));if(r.close(),y.length>0)throw new Error("В бэкапе отсутствуют обязательные таблицы: "+y.join(", "));localStorage.setItem(Me,JSON.stringify(i)),$=null}const it="uzlang-auto-backup-index-v1",st="uzlang-auto-backup-v1-",ca="uzlang-last-auto-backup-date-v1",rt="uzlang-last-manual-export-date-v1",da="uzlang-last-backup-reminder-date-v1",X=20;function ha(a){const i=[...a];for(let s=i.length-1;s>0;s-=1){const r=Math.floor(Math.random()*(s+1));[i[s],i[r]]=[i[r],i[s]]}return i}function Le(a,i){const s=new Set([a]),r=ha(i.filter(o=>o!==a));for(let o=0;o<r.length&&s.size<4;o+=1)s.add(r[o]);for(;s.size<4;)s.add("Не знаю");return ha(Array.from(s))}function pt(a){return(a.match(/[A-Za-z\u00c0-\u024f\u0400-\u04ffʻ’'`-]+/g)||[]).map(i=>i.trim())}function Ae(a){return a.toLowerCase().replace(/[’`]/g,"ʻ").replace(/[^a-z\u00c0-\u024f\u0400-\u04ffʻ'-]/g,"")}function nt(a){return pt(a).map(Ae).join(" ")}function Ui(a){const i=a.map((s,r)=>({word:s,index:r})).filter(s=>Ae(s.word).length>2);return i.length>0?i[Math.floor(Math.random()*i.length)].index:Math.max(0,a.length-1)}function _i(a,i,s){if(i==="translate")return{type:i,card:a,options:Le(a.ru,s)};const r=pt(a.exampleUz||a.uz);if(r.length<2)return{type:"translate",card:a,options:Le(a.ru,s)};if(i==="assemble")return{type:i,card:a,pieces:ha(r.map((m,d)=>({id:a.id+"-w-"+d,word:m}))),correctWords:r};const o=Ui(r);return{type:"missing",card:a,missingWord:r[o],maskedPhrase:r.map((m,d)=>d===o?"____":m).join(" ")}}function qi(a){return a>=5e4?"Наставник (Ustoz)":a>=2e4?"Мастер (Usta)":a>=8e3?"Активный (Faol)":a>=2e3?"Ученик (O‘rganuvchi)":"Новичок (Boshlovchi)"}function Li(a,i){const s=new Date(a+"T00:00:00"),r=new Date(i+"T00:00:00");return Math.floor((r.getTime()-s.getTime())/864e5)}function ot({title:a,subtitle:i,data:s,valueKey:r="count",labelKey:o="label",color:m="primary.main",yMax:d=null}){const y=s.map(S=>Number(S[r]||0)),k=d||Math.max(1,...y);return e.jsx(E,{variant:"outlined",sx:{p:1.5},children:e.jsxs(c,{spacing:1,children:[e.jsx(l,{variant:"subtitle1",children:a}),i?e.jsx(l,{variant:"caption",color:"text.secondary",children:i}):null,e.jsx(c,{direction:"row",alignItems:"flex-end",spacing:.5,sx:{minHeight:120},children:s.map(S=>{const K=Number(S[r]||0),T=Math.max(6,Math.round(K/k*100));return e.jsx(qe,{title:`${S[o]}: ${K}`,children:e.jsxs(c,{spacing:.4,alignItems:"center",sx:{flex:1,minWidth:0},children:[e.jsx(re,{sx:{width:"100%",maxWidth:18,height:`${T}px`,borderRadius:.75,bgcolor:m}}),e.jsx(l,{variant:"caption",color:"text.secondary",noWrap:!0,children:S[o]})]})},String(S[o]))})})]})})}function Ai({steps:a,activeStepIndex:i}){const s=a[i]||null;return e.jsx(E,{variant:"outlined",sx:{p:1.5},children:e.jsxs(c,{spacing:1.25,children:[e.jsx(l,{variant:"subtitle1",children:"Освоение по шагам"}),e.jsx(l,{variant:"caption",color:"text.secondary",children:"Компактная карта шагов без числовой шкалы"}),e.jsx(re,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(34px, 1fr))",gap:.6},children:a.map((r,o)=>{const m=o===i,d=r.completed?"success.main":m?"warning.main":r.masteredPercent>=50?"info.main":"grey.400";return e.jsx(qe,{title:`Шаг ${o+1}: ${r.masteredPercent}% • тест 10/10: ${r.quizSuccess>0?"да":"нет"}`,children:e.jsx(re,{sx:{height:30,borderRadius:1,bgcolor:d,color:"#fff",display:"grid",placeItems:"center",fontSize:12,fontWeight:700,border:m?"2px solid rgba(0,0,0,0.45)":"1px solid rgba(0,0,0,0.12)"},children:o+1})},`step-cell-${o}`)})}),s?e.jsx(E,{variant:"outlined",sx:{p:1},children:e.jsxs(l,{variant:"body2",children:["Текущий шаг ",i+1,": освоено ",s.masteredPercent,"% • тест 10/10:"," ",s.quizSuccess>0?"да":"нет"]})}):null]})})}function me({item:a,reveal:i,canSpeak:s,onSpeakText:r,isWord:o=!1}){return a?e.jsxs(Zt,{elevation:2,children:[a.imageUrl?e.jsx(ei,{component:"img",image:a.imageUrl,alt:"Тема карточки",sx:{height:170,objectFit:"cover"}}):null,e.jsx(ai,{children:e.jsxs(c,{spacing:1.5,children:[e.jsxs(c,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(l,{variant:"h5",children:a.uz}),s?e.jsx(qe,{title:"Озвучить",children:e.jsx(ua,{color:"primary",onClick:()=>r(a.reading||a.uz),children:e.jsx(Xa,{})})}):null]}),e.jsx(l,{color:"text.secondary",children:a.reading}),i?e.jsx(l,{variant:"h6",children:a.ru}):null,!o&&i?e.jsxs(e.Fragment,{children:[e.jsx(ti,{}),e.jsxs(c,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(l,{children:a.exampleUz}),s?e.jsx(qe,{title:"Озвучить пример",children:e.jsx(ua,{size:"small",color:"primary",onClick:()=>r(a.exampleReading||a.exampleUz),children:e.jsx(Xa,{fontSize:"small"})})}):null]}),e.jsx(l,{color:"text.secondary",children:a.exampleRu})]}):null,o?e.jsx(l,{variant:"body2",color:"text.secondary",children:a.topicTitle?`Тема: ${a.topicTitle}`:"Слово шага"}):null]})})]}):null}function Wi({colorMode:a="light",onToggleColorMode:i=()=>{}}){const[s,r]=u.useState(!0),[o,m]=u.useState("words"),[d,y]=u.useState(!1),[k,S]=u.useState(!1),[K,T]=u.useState({date:"",count:0}),D=u.useRef(null),F=u.useRef(!0),[C,W]=u.useState(0),[p,_]=u.useState(0),[j,U]=u.useState([]),[R,z]=u.useState(null),[H,Z]=u.useState([]),[he,De]=u.useState(0),[ze,ya]=u.useState(!1),[We,yt]=u.useState([]),[xa,ba]=u.useState(0),[we,fa]=u.useState([]),[ke,va]=u.useState(0),[Be,za]=u.useState(0),[xt,wa]=u.useState(!1),[ne,ge]=u.useState([]),[Ee,Ke]=u.useState(""),[ka,Ea]=u.useState([]),[Ta,Sa]=u.useState(!1),[bt,ft]=u.useState({total:0,byLevel:[]}),[q,vt]=u.useState({stepSize:X,totalWords:0,totalSteps:1,activeStepIndex:0,completedSteps:0,steps:[]}),[Y,Te]=u.useState(0),[Fe,zt]=u.useState({level:1,words:{totalLevel:0,learnedLevel:0,masteredLevel:0,dueLevel:0,learnedTotal:0,masteredTotal:0},phrases:{total:0,learned:0,mastered:0,due:0},quiz:{success:0,fail:0},unlockedLevel:1}),[w,wt]=u.useState({date:"",wordsTarget:20,wordsDone:0,wordsCompleted:!1,perfectTestsTarget:1,perfectTestsDone:0,perfectTestsCompleted:!1,allCompleted:!1,streak:{current:0,longest:0,nextMilestone:3,progressPercent:0}}),[ja,Ra]=u.useState({dailyReviews:[],weeklyPerfectTests:[],levelProgress:[]}),[oe,kt]=u.useState(14),[le,Et]=u.useState(8),[ee,Tt]=u.useState([]),[pe,Se]=u.useState(0),[Pe,Ye]=u.useState([]),[Na,je]=u.useState(0),[ye,Ca]=u.useState([]),[Re,Ge]=u.useState(0),[Qe,He]=u.useState(0),[St,Xe]=u.useState(!1),[Ia,$e]=u.useState([]),[Oa,Je]=u.useState(!1),[xe,Ve]=u.useState(null),ae=typeof window<"u"&&"speechSynthesis"in window&&typeof window.SpeechSynthesisUtterance=="function",Ua=u.useMemo(()=>j.find(t=>t.id===R),[j,R]),jt=H[he],Ne=We[xa],N=we[ke],Rt=ee[pe],Ce=Pe[Na],ie=ye[Re],I=q.steps[Y]||null,Nt=Math.min(Math.max(0,q.totalSteps-1),q.completedSteps),Ct=Fe.words.learnedTotal,It=Fe.words.masteredTotal,_a=I?I.learnedPercent:0,Ot=q.steps.filter(t=>t.quizSuccess>0).length,qa=q.completedSteps*500+Ot*120+((I==null?void 0:I.learnedPercent)||0)*4,Ut=qi(qa),La=[...q.completedSteps>=1?["Step 1 complete"]:[],...q.completedSteps>=3?["Step 3 complete"]:[],...q.completedSteps>=7?["Step 7 complete"]:[],...q.completedSteps>=14?["Step 14 complete"]:[],...w.streak.current>=3?["Streak 3"]:[],...w.streak.current>=7?["Streak 7"]:[],...w.streak.current>=14?["Streak 14"]:[]];function ce(t){if(!ae||!t)return;window.speechSynthesis.cancel();const n=new window.SpeechSynthesisUtterance(t);n.lang="uz-UZ",n.rate=.92;const x=window.speechSynthesis.getVoices().find(v=>v.lang.toLowerCase().startsWith("uz"));x&&(n.voice=x),window.speechSynthesis.speak(n)}async function Aa(){try{const t=await at(),n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),h="uzlang-progress-"+new Date().toISOString().slice(0,10)+".json",x=URL.createObjectURL(n),v=document.createElement("a");v.href=x,v.download=h,v.click(),URL.revokeObjectURL(x),localStorage.setItem(rt,new Date().toISOString().slice(0,10)),localStorage.setItem(da,new Date().toISOString().slice(0,10))}catch(t){alert("Не удалось экспортировать прогресс: "+t.message)}}async function _t(){const t=new Date().toISOString().slice(0,10),n=localStorage.getItem(ca);let h;try{h=JSON.parse(localStorage.getItem(it)||"[]"),Array.isArray(h)||(h=[])}catch{h=[]}if(n!==t)try{const B=await at(),Ue=st+t;localStorage.setItem(Ue,JSON.stringify(B));const J=[t,...h.filter(P=>P!==t)].slice(0,14);h.filter(P=>!J.includes(P)).forEach(P=>localStorage.removeItem(st+P)),localStorage.setItem(it,JSON.stringify(J)),localStorage.setItem(ca,t),h=J}catch{}T({date:localStorage.getItem(ca)||"",count:h.length});const x=localStorage.getItem(rt),v=localStorage.getItem(da);(!x||Li(x,t)>=3)&&v!==t&&S(!0)}async function qt(t){const n=t.target.files&&t.target.files[0];if(n)try{const h=await n.text(),x=JSON.parse(h);await Oi(x),alert("Прогресс импортирован. Страница будет обновлена."),window.location.reload()}catch(h){alert("Ошибка импорта: "+h.message)}finally{D.current&&(D.current.value="")}}function Lt(){D.current&&D.current.click()}async function be(t){const n=await Ni(t);zt(n)}async function Ie(){const t=await Ii();wt(t)}async function Ze(t={}){const{preserveActiveStep:n=!1}=t,h=await gt(X);return vt(h),Te(n?x=>{const v=Math.max(0,h.totalSteps-1);return Math.min(Math.max(0,x),v)}:h.activeStepIndex),h}const de=u.useCallback(async(t=oe,n=le)=>{const h=await tt(t,n);Ra(h)},[oe,le]);async function Ma(){const t=await Ei(30);yt(t),ba(0)}function Da(t,n=null){const h=t.find(v=>v.id===n);if(h&&h.unlocked)return h.id;const x=t.find(v=>v.unlocked);return x?x.id:null}async function Wa(t){const n=await ki(t);Z(n),De(0)}async function ea(t){const n=await Ti(t,10),h=n.map(G=>G.ru),x=["translate","assemble","missing"],v=n.map((G,B)=>_i(G,x[B%x.length],h));fa(v),va(0),za(0),wa(!1),ge([]),Ke(""),Ea([]),Sa(!1)}async function At(t){const n=await Za(t,X,30);return Ye(n),je(0),n}async function Mt(t){const n=await la(t,X);Ye(n),je(0)}async function Dt(t,n=null){const h=await et(t,X,10),v=(n||await la(t,X)).map(B=>B.ru),G=h.map(B=>({...B,options:Le(B.ru,v)}));Ca(G),Ge(0),He(0),Xe(!1),$e([]),Je(!1),Ve(null)}const Oe=u.useCallback(async t=>{const n=await la(t,X);Tt(n),Se(0);const h=await Za(t,X,30);Ye(h),je(0);const x=await et(t,X,10),v=n.map(B=>B.ru),G=x.map(B=>({...B,options:Le(B.ru,v)}));Ca(G),Ge(0),He(0),Xe(!1),$e([]),Je(!1)},[]);u.useEffect(()=>{async function t(){const[n,h]=await Promise.all([oa(),ji()]);U(n),ft(h);const x=Da(n);x?(z(x),await Wa(x),await ea(x)):(z(null),Z([]),fa([])),await Ma();const v=await Ze();await Oe(v.activeStepIndex),await be(1),await Ie();const G=await tt(14,8);Ra(G),await _t(),r(!1)}return t(),()=>{ae&&window.speechSynthesis.cancel()}},[ae,Oe]),u.useEffect(()=>{if(!R)return;const t=j.find(n=>n.id===R);!t||!t.unlocked||(Wa(R),ea(R))},[R,j]),u.useEffect(()=>{if(j.length===0)return;const t=Da(j,R);t!==R&&z(t)},[j,R]),u.useEffect(()=>{s||de(oe,le)},[s,oe,le,de]),u.useEffect(()=>{if(F.current){F.current=!1;return}async function t(){await Oe(Y),await be(1)}t()},[Y,de,Oe]);async function aa(t){if(!Ne)return;await Si(Ne.id,t);const n=xa+1;n<We.length?ba(n):await Ma(),await be(1),await Ie(),await de()}async function ta(t){if(!Ce)return;await Ri(Ce.id,t);const n=Na+1;n<Pe.length?je(n):await At(Y),await be(1),await Ie(),await de(),await Ze({preserveActiveStep:!0});const h=await oa();U(h)}function Wt(t,n){if(!t)return;const h=t.type==="translate"?t.card.uz:t.card.exampleRu,x=t.type==="translate"?t.card.ru:t.type==="assemble"?t.correctWords.join(" "):t.missingWord;Ea(v=>[...v,{id:t.card.id+"-"+t.type+"-"+ke,type:t.type,prompt:h,correctAnswer:x,userAnswer:n||"—"}])}function ia(t,n=""){t||Wt(N,n);const h=t?Be+1:Be;if(za(h),ke+1>=we.length){wa(!0);return}va(x=>x+1),ge([]),Ke("")}function Bt(t){ge(n=>n.includes(t)?n:[...n,t])}function Kt(t){ge(n=>n.filter(h=>h!==t))}function Ft(){ge([])}function Pt(){if(!N||N.type!=="assemble")return;const t=new Map(N.pieces.map(x=>[x.id,x.word])),n=ne.map(x=>t.get(x)).filter(Boolean).join(" "),h=N.correctWords.join(" ");ia(nt(n)===nt(h),n)}function Yt(){if(!N||N.type!=="missing")return;const t=Ae(Ee),n=Ae(N.missingWord);ia(!!t&&t===n,Ee)}async function Gt(t,n=""){!t&&ie&&$e(v=>[...v,{id:ie.id+"-"+Re,prompt:ie.uz,correctAnswer:ie.ru,userAnswer:n||"—"}]);const h=t?Qe+1:Qe,x=Re+1>=ye.length;if(He(h),x){const v=ye.length||10,G=new Set(j.filter(J=>J.unlocked).map(J=>J.id));Xe(!0),await Ci(Y,h,v),await be(1),await Ie(),await de();const B=await Ze({preserveActiveStep:!0}),Ue=await oa();if(U(Ue),h===v){const J=Ue.filter(P=>P.unlocked),Ba=J.filter(P=>!G.has(P.id));Ve({completedSteps:B.completedSteps,newlyUnlockedTitles:Ba.map(P=>P.title),unlockedTitles:J.map(P=>P.title)})}else Ve(null);return}Ge(v=>v+1)}return s?e.jsx(re,{minHeight:"100vh",display:"grid",sx:{placeItems:"center"},children:e.jsx(Qt,{})}):e.jsxs(e.Fragment,{children:[e.jsx(Ht,{position:"sticky",color:"primary",elevation:1,children:e.jsx(Ka,{maxWidth:"md",children:e.jsxs(re,{py:1.5,display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},justifyContent:"space-between",gap:1,children:[e.jsxs(c,{spacing:.25,children:[e.jsx(l,{variant:"h6",lineHeight:1.1,children:"UzLang"}),e.jsx(l,{variant:"body2",sx:{opacity:.95},children:"Самоучитель узбекского языка"})]}),e.jsxs(c,{direction:"row",spacing:1,alignItems:{xs:"flex-start",sm:"center"},sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsxs(l,{variant:"body2",sx:{opacity:.9,textAlign:{xs:"left",sm:"right"},width:{xs:"100%",sm:"auto"}},children:["Сначала слова, потом фразы:",e.jsx("br",{}),"короткие повторения каждый день"]}),e.jsx(ua,{size:"small",color:"inherit",onClick:i,sx:{mt:{xs:.25,sm:0},ml:{xs:0,sm:.5}},children:a==="dark"?e.jsx(Xt,{fontSize:"small"}):e.jsx($t,{fontSize:"small"})})]})]})})}),e.jsx(Ka,{maxWidth:"md",sx:{py:3},children:e.jsxs(c,{spacing:2,children:[e.jsxs(E,{sx:{p:2},children:[e.jsxs(c,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:{xs:"stretch",sm:"center"},justifyContent:"space-between",children:[e.jsxs(c,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:{xs:"stretch",sm:"center"},sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsxs(sa,{color:"primary",exclusive:!0,value:o,onChange:(t,n)=>{n&&m(n)},children:[e.jsx(se,{value:"words",children:"Слова"}),e.jsx(se,{value:"phrases",children:"Фразы"})]}),o==="words"?e.jsxs(e.Fragment,{children:[e.jsx(V,{label:`Слов в базе: ${bt.total}`,color:"secondary"}),e.jsx(V,{label:`Шаг ${Y+1} / ${q.totalSteps}`,color:"primary"})]}):null]}),e.jsxs(re,{sx:{width:"100%",display:"flex",flexDirection:{xs:"column",sm:"row"},flexWrap:{xs:"nowrap",sm:"wrap"},gap:1,justifyContent:{xs:"stretch",sm:"flex-end"}},children:[e.jsx(b,{size:"small",variant:"outlined",onClick:Aa,sx:{width:{xs:"100%",sm:"auto"}},children:"Экспорт прогресса"}),e.jsx(b,{size:"small",variant:"outlined",onClick:Lt,sx:{width:{xs:"100%",sm:"auto"}},children:"Импорт прогресса"}),e.jsx(b,{size:"small",variant:"outlined",onClick:()=>y(!0),sx:{width:{xs:"100%",sm:"auto"}},children:"Как заниматься"})]})]}),e.jsxs(l,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:["Авто-бэкап: ",K.date||"нет"," • локальных копий: ",K.count]})]}),o==="phrases"?e.jsxs(A,{container:!0,spacing:2,children:[e.jsx(A,{size:{xs:12,md:4},children:e.jsxs(E,{sx:{p:2},children:[e.jsx(l,{variant:"subtitle1",gutterBottom:!0,children:"Темы фраз"}),e.jsx(c,{spacing:1,children:j.map(t=>e.jsx(b,{variant:t.id===R?"contained":"outlined",disabled:!t.unlocked,onClick:()=>{t.unlocked&&z(t.id)},sx:{justifyContent:"flex-start"},children:t.unlocked?t.title:`${t.title} (${t.learnedWords}/${t.totalWords})`},t.id))}),j.some(t=>!t.unlocked)?e.jsx(l,{variant:"caption",color:"text.secondary",sx:{mt:1},children:"Тема откроется после изучения всех слов этой темы."}):null,Ua?e.jsx(l,{color:"text.secondary",sx:{mt:1.5},children:Ua.description}):null]})}),e.jsx(A,{size:{xs:12,md:8},children:e.jsx(E,{sx:{p:2},children:R?e.jsxs(e.Fragment,{children:[e.jsxs(Fa,{value:C,onChange:(t,n)=>W(n),variant:"fullWidth",children:[e.jsx(ue,{label:"Учить"}),e.jsx(ue,{label:"Повторить"}),e.jsx(ue,{label:"Тест"})]}),e.jsxs(re,{sx:{mt:2},children:[C===0?e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(V,{label:`${he+1} / ${H.length||1}`}),e.jsx(b,{onClick:()=>ya(t=>!t),children:ze?"Скрыть перевод":"Показать перевод"})]}),e.jsx(me,{item:jt,reveal:ze,canSpeak:ae,onSpeakText:ce}),e.jsxs(c,{direction:"row",spacing:1,children:[e.jsx(b,{variant:"outlined",disabled:he===0,onClick:()=>{De(t=>Math.max(0,t-1))},children:"Назад"}),e.jsx(b,{variant:"contained",disabled:H.length===0,onClick:()=>{De(t=>H.length===0?0:Math.min(H.length-1,t+1))},children:"Дальше"})]})]}):null,C===1?e.jsxs(c,{spacing:2,children:[e.jsxs(l,{variant:"subtitle1",children:["Карточек к повторению: ",We.length]}),Ne?e.jsxs(e.Fragment,{children:[e.jsx(me,{item:Ne,reveal:!0,canSpeak:ae,onSpeakText:ce}),e.jsx(l,{color:"text.secondary",children:"Насколько легко вспомнили?"}),e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(b,{color:"error",variant:"outlined",onClick:()=>aa(1),children:"Тяжело"}),e.jsx(b,{color:"warning",variant:"outlined",onClick:()=>aa(3),children:"Нормально"}),e.jsx(b,{color:"success",variant:"contained",onClick:()=>aa(5),children:"Легко"})]})]}):e.jsx(O,{severity:"success",children:"Сегодня всё повторено. Отлично."})]}):null,C===2?e.jsx(c,{spacing:2,children:!xt&&N?e.jsxs(e.Fragment,{children:[e.jsx(V,{label:`Вопрос ${ke+1} / ${we.length||1}`}),N.type==="translate"?e.jsxs(e.Fragment,{children:[e.jsx(me,{item:N.card,reveal:!1,canSpeak:ae,onSpeakText:ce}),e.jsx(l,{children:"Что это значит?"}),e.jsx(c,{spacing:1,children:N.options.map(t=>e.jsx(b,{variant:"outlined",onClick:()=>ia(t===N.card.ru,t),sx:{justifyContent:"flex-start"},children:t},t))})]}):null,N.type==="assemble"?e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{color:"text.secondary",children:"Соберите фразу на узбекском по переводу:"}),e.jsx(O,{severity:"info",children:N.card.exampleRu}),e.jsx(E,{variant:"outlined",sx:{p:1.5,minHeight:70},children:e.jsx(c,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:ne.length===0?e.jsx(l,{color:"text.secondary",children:"Выберите слова в правильном порядке"}):ne.map(t=>{const n=N.pieces.find(h=>h.id===t);return n?e.jsx(b,{size:"small",onClick:()=>Kt(t),children:n.word},t):null})})}),e.jsx(c,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:N.pieces.filter(t=>!ne.includes(t.id)).map(t=>e.jsx(b,{size:"small",variant:"outlined",onClick:()=>Bt(t.id),children:t.word},t.id))}),e.jsxs(c,{direction:"row",spacing:1,children:[e.jsx(b,{variant:"outlined",onClick:Ft,disabled:ne.length===0,children:"Сбросить"}),e.jsx(b,{variant:"contained",onClick:Pt,disabled:ne.length!==N.correctWords.length,children:"Проверить"})]})]}):null,N.type==="missing"?e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{color:"text.secondary",children:"Введите пропущенное слово:"}),e.jsx(O,{severity:"info",children:N.card.exampleRu}),e.jsx(E,{variant:"outlined",sx:{p:1.5},children:e.jsx(l,{variant:"h6",children:N.maskedPhrase})}),e.jsx(Pa,{label:"Пропущенное слово",value:Ee,onChange:t=>Ke(t.target.value),size:"small",autoComplete:"off"}),e.jsx(b,{variant:"contained",onClick:Yt,disabled:!Ee.trim(),children:"Проверить"})]}):null]}):e.jsxs(e.Fragment,{children:[e.jsxs(O,{severity:"info",children:["Результат: ",Be," из ",we.length]}),e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(b,{variant:"contained",onClick:()=>ea(R),children:"Пройти ещё раз"}),ka.length>0?e.jsx(b,{variant:"outlined",onClick:()=>Sa(t=>!t),children:Ta?"Скрыть разбор":"Разбор ошибок"}):null]}),Ta?e.jsx(E,{variant:"outlined",sx:{p:1.5},children:e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle1",children:"Ошибки в тесте фраз"}),ka.map(t=>e.jsx(E,{variant:"outlined",sx:{p:1.25},children:e.jsxs(c,{spacing:.5,children:[e.jsxs(l,{variant:"body2",color:"text.secondary",children:["Задание: ",t.prompt]}),e.jsxs(l,{variant:"body2",children:["Ваш ответ: ",t.userAnswer]}),e.jsxs(l,{variant:"body2",children:["Правильно: ",t.correctAnswer]})]})},t.id))]})}):null]})}):null]})]}):e.jsx(O,{severity:"warning",sx:{mb:2},children:"Пока нет доступных тем фраз. Сначала пройдите слова текущего шага."})})})]}):null,o==="words"?e.jsxs(E,{sx:{p:2},children:[e.jsxs(Fa,{value:p,onChange:(t,n)=>_(n),variant:"fullWidth",children:[e.jsx(ue,{label:"Учить слова"}),e.jsx(ue,{label:"Повтор слов"}),e.jsx(ue,{label:"Тест слов"})]}),e.jsxs(re,{sx:{mt:2},children:[e.jsxs(O,{severity:"info",sx:{mb:2},children:["Задание на шаг: выучить ",X," слов, пройти повторы и сдать тест на 10/10. Пока шаг не закрыт, следующий не открывается."]}),p===0?e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"stretch",sm:"center"},spacing:1,children:[e.jsx(V,{label:`${pe+1} / ${ee.length||1}`}),e.jsx(Pa,{select:!0,size:"small",value:Y,SelectProps:{native:!0},onChange:t=>{const n=Number(t.target.value);Te(n),_(0),m("words")},sx:{minWidth:220,maxWidth:280},children:q.steps.map((t,n)=>n<=Nt?e.jsx("option",{value:n,children:`Шаг ${n+1}${t.completed?" ✓":""}`},`step-option-${n}`):null)}),e.jsx(b,{onClick:()=>ya(t=>!t),children:ze?"Скрыть перевод":"Показать перевод"})]}),e.jsx(me,{item:Rt,reveal:ze,canSpeak:ae,onSpeakText:ce,isWord:!0}),e.jsxs(c,{direction:"row",spacing:1,children:[e.jsx(b,{variant:"outlined",disabled:pe===0,onClick:()=>{Se(t=>Math.max(0,t-1))},children:"Назад"}),e.jsx(b,{variant:"contained",disabled:ee.length===0||pe>=Math.max(0,ee.length-1),onClick:()=>{Se(t=>ee.length===0?0:Math.min(ee.length-1,t+1))},children:"Дальше"})]}),ee.length>0&&pe>=ee.length-1?e.jsx(E,{variant:"outlined",sx:{p:1.5},children:e.jsxs(c,{spacing:1.25,children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Слова шага закончились. Выберите действие."}),e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(b,{variant:"outlined",onClick:()=>Se(0),children:"Учить заново"}),e.jsx(b,{variant:"contained",onClick:()=>_(1),children:"Перейти к повтору"})]})]})}):null]}):null,p===1?e.jsxs(c,{spacing:2,children:[e.jsxs(l,{variant:"subtitle1",children:["Слов к повторению: ",Pe.length]}),Ce?e.jsxs(e.Fragment,{children:[e.jsx(me,{item:Ce,reveal:!0,canSpeak:ae,onSpeakText:ce,isWord:!0}),e.jsx(l,{color:"text.secondary",children:"Насколько легко вспомнили?"}),e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(b,{color:"error",variant:"outlined",onClick:()=>ta(1),children:"Тяжело"}),e.jsx(b,{color:"warning",variant:"outlined",onClick:()=>ta(3),children:"Нормально"}),e.jsx(b,{color:"success",variant:"contained",onClick:()=>ta(5),children:"Легко"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{severity:"info",children:"Базовые повторы шага закрыты. Можно сразу идти в тест или повторить шаг ещё раз."}),e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(b,{variant:"outlined",onClick:()=>Mt(Y),children:"Повторить шаг снова"}),e.jsx(b,{variant:"contained",onClick:()=>_(2),children:"Перейти к тесту"})]})]})]}):null,p===2?e.jsx(c,{spacing:2,children:!St&&ie?e.jsxs(e.Fragment,{children:[e.jsx(V,{label:`Слово ${Re+1} / ${ye.length||1}`}),e.jsx(me,{item:ie,reveal:!1,canSpeak:ae,onSpeakText:ce,isWord:!0}),e.jsx(l,{children:"Выберите перевод слова:"}),e.jsx(c,{spacing:1,children:ie.options.map(t=>e.jsx(b,{variant:"outlined",onClick:()=>Gt(t===ie.ru,t),sx:{justifyContent:"flex-start"},children:t},t))})]}):e.jsxs(e.Fragment,{children:[e.jsxs(O,{severity:"info",children:["Результат: ",Qe," из ",ye.length]}),xe?e.jsxs(O,{severity:"success",children:[e.jsx(l,{variant:"body2",sx:{fontWeight:700},children:"Поздравляем, тест сдан на 10/10."}),e.jsxs(l,{variant:"body2",children:["Вы прошли шагов: ",xe.completedSteps,"."]}),xe.newlyUnlockedTitles.length>0?e.jsxs(l,{variant:"body2",children:["Новые доступные темы фраз: ",xe.newlyUnlockedTitles.join(", "),"."]}):e.jsxs(l,{variant:"body2",children:["Доступные темы фраз: ",xe.unlockedTitles.join(", "),"."]})]}):null,e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.jsx(b,{variant:"contained",onClick:()=>Dt(Y,ee),children:"Пройти ещё раз"}),Ia.length>0?e.jsx(b,{variant:"outlined",onClick:()=>Je(t=>!t),children:Oa?"Скрыть разбор":"Разбор ошибок"}):null]}),Oa?e.jsx(E,{variant:"outlined",sx:{p:1.5},children:e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{variant:"subtitle1",children:"Ошибки в тесте слов"}),Ia.map(t=>e.jsx(E,{variant:"outlined",sx:{p:1.25},children:e.jsxs(c,{spacing:.5,children:[e.jsxs(l,{variant:"body2",color:"text.secondary",children:["Слово: ",t.prompt]}),e.jsxs(l,{variant:"body2",children:["Ваш ответ: ",t.userAnswer]}),e.jsxs(l,{variant:"body2",children:["Правильно: ",t.correctAnswer]})]})},t.id))]})}):null]})}):null]})]}):null,e.jsx(E,{sx:{p:2},children:e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{variant:"h6",children:"Ваш прогресс"}),e.jsxs(l,{color:"text.secondary",children:["Шаг ",Y+1," из ",q.totalSteps,": изучено ",(I==null?void 0:I.learned)||0," из"," ",(I==null?void 0:I.total)||X,"."]}),e.jsx(_e,{variant:"determinate",value:_a,sx:{height:9,borderRadius:10}}),e.jsxs(A,{container:!0,spacing:1,children:[e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Прогресс шага"}),e.jsxs(l,{variant:"h6",children:[_a,"%"]})]})}),e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Завершено шагов"}),e.jsxs(l,{variant:"h6",children:[q.completedSteps," / ",q.totalSteps]})]})}),e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Слова изучено всего"}),e.jsx(l,{variant:"h6",children:Ct})]})}),e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Фразы к повтору"}),e.jsx(l,{variant:"h6",children:Fe.phrases.due})]})}),e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Тест шага 10/10"}),e.jsx(l,{variant:"h6",children:((I==null?void 0:I.quizSuccess)||0)>0?"Да":"Нет"})]})}),e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Слов освоено (2+)"}),e.jsx(l,{variant:"h6",children:It})]})}),e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Очки"}),e.jsx(l,{variant:"h6",children:qa})]})}),e.jsx(A,{size:{xs:12,sm:6,md:4},children:e.jsxs(E,{variant:"outlined",sx:{p:1.25,height:"100%"},children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:"Ранг"}),e.jsx(l,{variant:"h6",children:Ut})]})})]}),((I==null?void 0:I.quizSuccess)||0)>0?e.jsx(O,{severity:"success",children:"Тест шага сдан на 10/10. После полного изучения слов шаг закроется автоматически."}):e.jsx(O,{severity:"warning",children:"Для закрытия шага нужно минимум один раз сдать тест на 10/10."}),I!=null&&I.completed?e.jsx(O,{severity:"success",children:e.jsxs(c,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:{xs:"flex-start",sm:"center"},justifyContent:"space-between",children:[e.jsx(l,{variant:"body2",children:"Шаг завершен. Следующий шаг открыт."}),Y+1<q.totalSteps?e.jsx(b,{size:"small",variant:"outlined",onClick:()=>{Te(t=>Math.min(q.totalSteps-1,t+1)),_(0),m("words")},children:"Перейти к следующему шагу"}):null]})}):e.jsx(O,{severity:"info",children:"Цель шага: пройти все слова шага и сдать тест 10/10."}),La.length>0?e.jsx(c,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:La.map(t=>e.jsx(V,{label:t,color:"success",variant:"outlined"},t))}):e.jsx(l,{variant:"body2",color:"text.secondary",children:"Награды появятся после завершения шагов и серии дней."})]})}),e.jsx(E,{sx:{p:2},children:e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{variant:"h6",children:"Ежедневные цели"}),e.jsx(l,{color:"text.secondary",children:"Сегодня: 20 повторов слов и 1 тест слов на 10/10."}),e.jsxs(c,{spacing:.75,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{variant:"body2",children:["Слова: ",w.wordsDone," / ",w.wordsTarget]}),e.jsx(V,{size:"small",color:w.wordsCompleted?"success":"default",label:w.wordsCompleted?"Выполнено":"В процессе"})]}),e.jsx(_e,{variant:"determinate",value:Math.min(100,Math.round(w.wordsDone/w.wordsTarget*100)),sx:{height:8,borderRadius:8}})]}),e.jsxs(c,{spacing:.75,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{variant:"body2",children:["Тест 10/10: ",w.perfectTestsDone," / ",w.perfectTestsTarget]}),e.jsx(V,{size:"small",color:w.perfectTestsCompleted?"success":"default",label:w.perfectTestsCompleted?"Выполнено":"В процессе"})]}),e.jsx(_e,{variant:"determinate",value:Math.min(100,Math.round(w.perfectTestsDone/w.perfectTestsTarget*100)),sx:{height:8,borderRadius:8}})]}),w.allCompleted?e.jsx(O,{severity:"success",children:"Ежедневные цели выполнены. Отличная работа."}):e.jsx(O,{severity:"info",children:"Закройте обе цели, чтобы завершить дневной план."}),e.jsx(E,{variant:"outlined",sx:{p:1.5,borderColor:w.streak.current>0?"warning.main":"divider",background:w.streak.current>0?"linear-gradient(90deg, rgba(255,167,38,0.10) 0%, rgba(255,152,0,0.04) 100%)":"transparent"},children:e.jsxs(c,{spacing:1.25,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Jt,{color:w.streak.current>0?"warning":"disabled"}),e.jsxs(l,{variant:"subtitle1",children:["Серия: ",w.streak.current," дн."]})]}),e.jsx(V,{size:"small",icon:e.jsx(Vt,{}),label:`Рекорд: ${w.streak.longest} дн.`,color:w.streak.longest>0?"secondary":"default"})]}),e.jsxs(l,{variant:"body2",color:"text.secondary",children:["До следующей отметки: ",w.streak.nextMilestone," дней подряд."]}),e.jsx(_e,{variant:"determinate",value:w.streak.progressPercent,color:"warning",sx:{height:8,borderRadius:8}}),w.streak.current>=30?e.jsx(O,{severity:"success",children:"Мощная серия. Вы идете в очень стабильном ритме."}):w.streak.current>=7?e.jsx(O,{severity:"success",children:"Отличная динамика. Серия уже крепкая."}):w.streak.current>=1?e.jsx(O,{severity:"info",children:"Серия запущена. Не прерывайте ритм завтра."}):e.jsx(O,{severity:"warning",children:"Сегодня можно начать новую серию."})]})})]})}),e.jsx(E,{sx:{p:2},children:e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{variant:"h6",children:"Аналитика"}),e.jsxs(c,{direction:{xs:"column",sm:"row"},spacing:1.5,alignItems:{xs:"stretch",sm:"center"},justifyContent:"space-between",children:[e.jsxs(c,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Дни:"}),e.jsxs(sa,{size:"small",exclusive:!0,value:oe,onChange:(t,n)=>{n&&kt(Number(n))},children:[e.jsx(se,{value:7,children:"7"}),e.jsx(se,{value:14,children:"14"}),e.jsx(se,{value:30,children:"30"})]})]}),e.jsxs(c,{direction:"row",spacing:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(l,{variant:"body2",color:"text.secondary",children:"Недели:"}),e.jsxs(sa,{size:"small",exclusive:!0,value:le,onChange:(t,n)=>{n&&Et(Number(n))},children:[e.jsx(se,{value:4,children:"4"}),e.jsx(se,{value:8,children:"8"}),e.jsx(se,{value:12,children:"12"})]})]})]}),e.jsxs(A,{container:!0,spacing:1.5,children:[e.jsx(A,{size:{xs:12},children:e.jsx(ot,{title:"Повторы по дням",subtitle:`Последние ${oe} дней`,data:ja.dailyReviews,valueKey:"count",labelKey:"label",color:"primary.main"})}),e.jsx(A,{size:{xs:12},children:e.jsx(ot,{title:"Тесты 10/10 по неделям",subtitle:`Последние ${le} недель`,data:ja.weeklyPerfectTests,valueKey:"count",labelKey:"label",color:"secondary.main"})}),e.jsx(A,{size:{xs:12},children:e.jsx(Ai,{steps:q.steps,activeStepIndex:Y})})]})]})})]})}),e.jsx("input",{ref:D,type:"file",accept:"application/json",style:{display:"none"},onChange:qt}),e.jsxs(Ya,{open:d,onClose:()=>y(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Ga,{children:"Как заниматься без хаоса"}),e.jsx(Qa,{dividers:!0,children:e.jsxs(c,{spacing:1.5,children:[e.jsx(l,{children:"1. Проходи текущий шаг слов по порядку во вкладке «Учить слова»."}),e.jsx(l,{children:"2. После 20 слов переходи в «Повтор слов», затем в «Тест слов»."}),e.jsx(l,{children:"3. Шаг закрывается только когда слова шага закреплены и тест сдан на 10/10."}),e.jsx(l,{children:"4. Пока шаг не закрыт, следующий шаг не открывается."}),e.jsx(l,{children:"5. Рекомендуемый ритм: 20-30 минут в день, без длинных пауз."}),e.jsx(l,{color:"text.secondary",children:"Прогресс и очки сохраняются автоматически на этом устройстве."})]})}),e.jsx(Ha,{children:e.jsx(b,{onClick:()=>y(!1),variant:"contained",children:"Понятно"})})]}),e.jsxs(Ya,{open:k,onClose:()=>S(!1),maxWidth:"xs",fullWidth:!0,children:[e.jsx(Ga,{children:"Напоминание о бэкапе"}),e.jsx(Qa,{dividers:!0,children:e.jsxs(c,{spacing:1.25,children:[e.jsx(l,{children:"Прогресс автоматически сохраняется в локальные JSON-снимки. Рекомендуется также скачать резервную копию."}),e.jsx(l,{color:"text.secondary",children:"Если устройство или браузер очистит хранилище, только вручную скачанный файл поможет восстановить данные."})]})}),e.jsxs(Ha,{children:[e.jsx(b,{onClick:()=>{localStorage.setItem(da,new Date().toISOString().slice(0,10)),S(!1)},children:"Позже"}),e.jsx(b,{variant:"contained",onClick:async()=>{await Aa(),S(!1)},children:"Скачать сейчас"})]})]})]})}export{Wi as default};
